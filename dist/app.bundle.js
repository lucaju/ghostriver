/******/ (function(modules) { // webpackBootstrap
/******/ 	// install a JSONP callback for chunk loading
/******/ 	function webpackJsonpCallback(data) {
/******/ 		var chunkIds = data[0];
/******/ 		var moreModules = data[1];
/******/ 		var executeModules = data[2];
/******/
/******/ 		// add "moreModules" to the modules object,
/******/ 		// then flag all "chunkIds" as loaded and fire callback
/******/ 		var moduleId, chunkId, i = 0, resolves = [];
/******/ 		for(;i < chunkIds.length; i++) {
/******/ 			chunkId = chunkIds[i];
/******/ 			if(installedChunks[chunkId]) {
/******/ 				resolves.push(installedChunks[chunkId][0]);
/******/ 			}
/******/ 			installedChunks[chunkId] = 0;
/******/ 		}
/******/ 		for(moduleId in moreModules) {
/******/ 			if(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {
/******/ 				modules[moduleId] = moreModules[moduleId];
/******/ 			}
/******/ 		}
/******/ 		if(parentJsonpFunction) parentJsonpFunction(data);
/******/
/******/ 		while(resolves.length) {
/******/ 			resolves.shift()();
/******/ 		}
/******/
/******/ 		// add entry modules from loaded chunk to deferred list
/******/ 		deferredModules.push.apply(deferredModules, executeModules || []);
/******/
/******/ 		// run deferred modules when all chunks ready
/******/ 		return checkDeferredModules();
/******/ 	};
/******/ 	function checkDeferredModules() {
/******/ 		var result;
/******/ 		for(var i = 0; i < deferredModules.length; i++) {
/******/ 			var deferredModule = deferredModules[i];
/******/ 			var fulfilled = true;
/******/ 			for(var j = 1; j < deferredModule.length; j++) {
/******/ 				var depId = deferredModule[j];
/******/ 				if(installedChunks[depId] !== 0) fulfilled = false;
/******/ 			}
/******/ 			if(fulfilled) {
/******/ 				deferredModules.splice(i--, 1);
/******/ 				result = __webpack_require__(__webpack_require__.s = deferredModule[0]);
/******/ 			}
/******/ 		}
/******/
/******/ 		return result;
/******/ 	}
/******/
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// object to store loaded and loading chunks
/******/ 	// undefined = chunk not loaded, null = chunk preloaded/prefetched
/******/ 	// Promise = chunk loading, 0 = chunk loaded
/******/ 	var installedChunks = {
/******/ 		"main": 0
/******/ 	};
/******/
/******/ 	var deferredModules = [];
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	var jsonpArray = window["webpackJsonp"] = window["webpackJsonp"] || [];
/******/ 	var oldJsonpFunction = jsonpArray.push.bind(jsonpArray);
/******/ 	jsonpArray.push = webpackJsonpCallback;
/******/ 	jsonpArray = jsonpArray.slice();
/******/ 	for(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);
/******/ 	var parentJsonpFunction = oldJsonpFunction;
/******/
/******/
/******/ 	// add entry module to deferred list
/******/ 	deferredModules.push(["./src/app.js","vendors~main"]);
/******/ 	// run deferred modules when ready
/******/ 	return checkDeferredModules();
/******/ })
/************************************************************************/
/******/ ({

/***/ "./src/app.js":
/*!********************!*\
  !*** ./src/app.js ***!
  \********************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _wordpress_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./wordpress.js */ "./src/wordpress.js");


const pathname = window.location.pathname;
const search = window.location.search;

const loadDeepLink = async slug => {

	let theme = _wordpress_js__WEBPACK_IMPORTED_MODULE_0__["default"].getThemeBySlug(slug);

	if (theme) {
		await _wordpress_js__WEBPACK_IMPORTED_MODULE_0__["default"].showPage(theme);
	} else {
		const post = await _wordpress_js__WEBPACK_IMPORTED_MODULE_0__["default"].showPost({slug});

		//if no page found: 404
		if (!post) notFound404();
	}

};

const notFound404 = async () => {
	_wordpress_js__WEBPACK_IMPORTED_MODULE_0__["default"].changeBrowserHistory({slug: '/ghost-river/'});
	_wordpress_js__WEBPACK_IMPORTED_MODULE_0__["default"].initHome({notFound: true});
};

const goHome = async () => {
	_wordpress_js__WEBPACK_IMPORTED_MODULE_0__["default"].changeBrowserHistory({slug: '/ghost-river/'});
	_wordpress_js__WEBPACK_IMPORTED_MODULE_0__["default"].initHome({});
};
 
( async () => {
	if (pathname == '/ghost-river/') {

		if (!search) {
			goHome();
		} else {
			const url = new URL(window.location.href);
			const slug = url.searchParams.get('node');

			_wordpress_js__WEBPACK_IMPORTED_MODULE_0__["default"].changeBrowserHistory({slug});
			loadDeepLink(slug);
		}

	} else { 
		
		const deepLink = pathname.split('/')[2];
		location = `http://localhost:8888/ghost-river?node=${deepLink}`;
	}
})();

/***/ }),

/***/ "./src/config/config.json":
/*!********************************!*\
  !*** ./src/config/config.json ***!
  \********************************/
/*! exports provided: mapbox, wordpress, default */
/***/ (function(module) {

module.exports = JSON.parse("{\"mapbox\":{\"user\":\"saintpierremapping\",\"token\":\"pk.eyJ1Ijoic2FpbnRwaWVycmVtYXBwaW5nIiwiYSI6ImNqdDBpOXo4aDBkYmk0Nm5wMTU0MzhxcWcifQ.tH1TZXEMh4KOnahRKRl_BA\"},\"wordpress\":{\"local\":{\"endpoint\":\"http://localhost:8888/ghost-river/wp-json/\"},\"remote\":{\"endpoint\":\"http://labs.fluxo.art.br/ghost-river/wp-json/\"}}}");

/***/ }),

/***/ "./src/data/1834_A_Jobin_final-2.json":
/*!********************************************!*\
  !*** ./src/data/1834_A_Jobin_final-2.json ***!
  \********************************************/
/*! exports provided: type, name, crs, features, default */
/***/ (function(module) {

module.exports = JSON.parse("{\"type\":\"FeatureCollection\",\"name\":\"1834 A Jobin, final\",\"crs\":{\"type\":\"name\",\"properties\":{\"name\":\"urn:ogc:def:crs:OGC:1.3:CRS84\"}},\"features\":[{\"type\":\"Feature\",\"properties\":{\"Name\":\"1834 A Jobin, final\",\"description\":null,\"tessellate\":1},\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[-73.6269044295439,45.49570393151461],[-73.62712527721307,45.49527032378407],[-73.62748845019665,45.49485541265055],[-73.6277081740576,45.4944259817559],[-73.62792752557769,45.49399813165515],[-73.62814627336965,45.4935717403812],[-73.62838356557604,45.49303709269595],[-73.6284781209361,45.49248699166942],[-73.62857242254518,45.49193837273843],[-73.62864768324928,45.49150053671138],[-73.62872264715314,45.49106016229743],[-73.62865608057069,45.49060267287517],[-73.62874957003223,45.49005410781436],[-73.6288614014145,45.48939792683122],[-73.62907643255615,45.48898077402798],[-73.62943202404799,45.48857685382967],[-73.63003138350109,45.48842247593652],[-73.63038520503433,45.48801864592417],[-73.63073801876578,45.48761307030919],[-73.63109002197055,45.48720842687503],[-73.63130137944991,45.48679193813197],[-73.6316521809241,45.48639177004048],[-73.63214196219366,45.48600779499818],[-73.63263078482115,45.48562477325565],[-73.63283959086274,45.48521285169947],[-73.63318741824109,45.48481747388206],[-73.6333953189804,45.48440838039475],[-73.63346368017324,45.48398513613373],[-73.63353188064181,45.48356282089775],[-73.63363327809428,45.48292694816125],[-73.63371725704715,45.48239710036709],[-73.63393926295997,45.48188360101909],[-73.63428215374478,45.48149156289798],[-73.63462426653759,45.48110040764571],[-73.6349653664145,45.4807089075208],[-73.63530561497878,45.48031797655415],[-73.63564505544396,45.47992795574067],[-73.63584656481437,45.47952536457471],[-73.63591068675343,45.4791105405595],[-73.63611172771489,45.47871118951195],[-73.6364328257594,45.47842791101461],[-73.6369055358355,45.47805515862913],[-73.63737740180046,45.47768404785739],[-73.63771151159364,45.47729992043084],[-73.63818152401133,45.47693068438835],[-73.638514052127,45.47654805668584],[-73.63884580102697,45.47616632289284],[-73.63916198366447,45.47588739269819],[-73.63974887222284,45.47563608238297],[-73.64019923975609,45.47537164625832],[-73.6406488373789,45.47510765308696],[-73.64097658582254,45.47472931895678],[-73.64130355472405,45.47435186788705],[-73.64162979645127,45.47397540203801],[-73.64194142166886,45.47370030018404],[-73.64240096286906,45.47333854385694],[-73.64285906619286,45.47297701565748],[-73.64318248458159,45.47260442508935],[-73.64350562905892,45.4722335131257],[-73.64396161540554,45.47187578753325],[-73.64438993561018,45.47171665733809],[-73.64484250659872,45.47135766116673],[-73.64526800101758,45.47119628162693],[-73.64572011926063,45.47084052102322],[-73.64617121148413,45.47048556907626],[-73.64660887397054,45.47022976395559],[-73.64717848784454,45.46998685245564],[-73.64748092938386,45.46971806178843],[-73.64792799547192,45.46936519800321],[-73.64810925174422,45.46898797322501],[-73.64829010167084,45.46861159075912],[-73.64860317130217,45.46824924029176],[-73.64904802659272,45.46790086513006],[-73.64948031685266,45.46764995552677],[-73.64991192410905,45.46739944257688],[-73.65034174833838,45.46714822704652],[-73.65089178562799,45.46700686655657],[-73.65144133384447,45.46686577448562],[-73.65197986608929,45.46682150902078],[-73.65253854092437,45.46658407622696],[-73.65295387807313,45.46642984350219],[-73.65351150265353,45.46619345748217],[-73.65380613940839,45.46593249993162],[-73.65436280245592,45.46569754930347],[-73.65466371085003,45.46533989375549],[-73.65508541201868,45.46509137304841],[-73.65550764253388,45.46484428130104],[-73.65592903793085,45.46459741469361],[-73.65646070723255,45.46455293118041],[-73.65700450402802,45.46441589768632],[-73.65754548880794,45.46427732528762],[-73.65797322691341,45.46393703343102],[-73.65826043374717,45.46367884421053],[-73.65842611531944,45.46331446999797],[-73.65884227458139,45.46306976687636],[-73.65912843499923,45.4628133422532],[-73.65929284945848,45.46245103878356],[-73.65970779797834,45.4622082555256],[-73.66012206279251,45.461965874592],[-73.66040612012658,45.46171128270827],[-73.66056883939015,45.46135163940763],[-73.66111124642461,45.46112363028283],[-73.66152366560499,45.46088343206912],[-73.66204824088966,45.46084108768562],[-73.6625804947549,45.46070630453787],[-73.66274116470449,45.46034950761927],[-73.66315107213975,45.46011058076007],[-73.66356008084807,45.45987183278071],[-73.66409678433003,45.45964577750696],[-73.66450419170624,45.45940770734799],[-73.66491092849819,45.4591700224064],[-73.66532415877434,45.45884133360802],[-73.66572943585905,45.45860455963508],[-73.66588542570562,45.45825235352621],[-73.66591744645656,45.45779673460112],[-73.66594226018978,45.45743275459881],[-73.66622484005237,45.45709529803818],[-73.66650729130805,45.4567590089895],[-73.66703066060775,45.45662810278868],[-73.6671936734063,45.45619140219414],[-73.66746719469002,45.45594612821761],[-73.66787414683225,45.45562455983568],[-73.66827638542513,45.45539371823123],[-73.66867103469433,45.4551610758865],[-73.66907314771633,45.45484038329047],[-73.66947461131666,45.45461076411703],[-73.66974506730739,45.45436851326132],[-73.67014660912491,45.45404987863012],[-73.6706669805881,45.45383248538944],[-73.67106096469477,45.45360337382132],[-73.67120919124369,45.45326217272814],[-73.67135708982892,45.45292169865897],[-73.67138519376601,45.45248199553271],[-73.67153256647934,45.45214310449443],[-73.67167963940196,45.45180491647438],[-73.67170172639003,45.45145538498432],[-73.67172359082076,45.45110643609868],[-73.67173981486854,45.45084523693107],[-73.67177237796471,45.4503241014465],[-73.67191704673739,45.44998941250431],[-73.67230887508416,45.44967931426088],[-73.67233309855571,45.44924770421582],[-73.67272352447287,45.44893915441721],[-73.67298952695256,45.4486193177632],[-73.6732553776772,45.44830021741396],[-73.67354098792562,45.44789806546056],[-73.6735686941275,45.44747168884408],[-73.67382918585557,45.44715447837708],[-73.67409204895299,45.44683828259335],[-73.6741155752458,45.44641439204795],[-73.67413435121055,45.44607605592198],[-73.67403573566713,45.44564224017539],[-73.67381456997094,45.44528192681619],[-73.67346930432456,45.44491028889048],[-73.67348228657266,45.44465856288452],[-73.67345664364481,45.44306186421542],[-73.67383577927912,45.44284846651401],[-73.67397580362511,45.44252900631491],[-73.67399844504476,45.44211584432731],[-73.67389460907292,45.44177428491814],[-73.67366920402189,45.44142166438782],[-73.67319626212108,45.44112828333675],[-73.6729719951427,45.44077695945757],[-73.67262719571322,45.44041465225575],[-73.67240415557832,45.44006478208749],[-73.67217679408462,45.4397969784323],[-73.67183722553702,45.43935559448632],[-73.67161248456799,45.43900814230615],[-73.67126755985996,45.43864978047112],[-73.67104087616218,45.4383842819616],[-73.67069488027346,45.43810750713309],[-73.67034925899861,45.43783121594206],[-73.66988338349191,45.43754375477285],[-73.66953318330545,45.4373484887553],[-73.66894329794323,45.43713018893579],[-73.66834421850052,45.43707191812912],[-73.66785402887638,45.43718538757178],[-73.66738037714343,45.43705866599436],[-73.66690115132398,45.43701201479977],[-73.66630210589098,45.43695369762251],[-73.66583503555283,45.43674710536217],[-73.66549952646315,45.43639302078481],[-73.66515774149869,45.43611929196371],[-73.66481436523691,45.43584645928177],[-73.66434565743005,45.43564185203765],[-73.66388488608446,45.43543601616536],[-73.66342373073755,45.43523050398204],[-73.66307199114993,45.43511667265473],[-73.66259094212538,45.43507098344276],[-73.66211198964642,45.4350249676347],[-73.66162074521453,45.43513679371656],[-73.66123878588843,45.43534028854669],[-73.6609625591957,45.43563619257696],[-73.6605814427346,45.43583979505058],[-73.66019971783128,45.43604371892815],[-73.65970462701365,45.43615669854236],[-73.65932171841071,45.43636113559779],[-73.65905094692766,45.43665741351107],[-73.65877958546558,45.43695432555989],[-73.65850764496629,45.43725186701687],[-73.65813011050896,45.4373775891757],[-73.65762345651044,45.4375722574302],[-73.6571404439856,45.43752564795032],[-73.65665934267943,45.43747858380618],[-73.65605728981241,45.43742006258649],[-73.65545451042111,45.43736196886969],[-73.6549665481565,45.43739481491266],[-73.65458054622384,45.43760082710335],[-73.65442539725062,45.43791159029418],[-73.65439022276219,45.43823490132011],[-73.65423450475902,45.43854707801022],[-73.65407681448396,45.4388600871974],[-73.65357194114426,45.43897590347018],[-73.65296055582802,45.43899758751527],[-73.65222965069452,45.43892771288896],[-73.65162644535751,45.43886825019175],[-73.65135340768622,45.43908910871265],[-73.65106980598432,45.43939198634042],[-73.65078519288613,45.43969554888992],[-73.65050194144398,45.43999929368094],[-73.65009595391558,45.44029217781201],[-73.64970929702287,45.4404211917692],[-73.64918968534325,45.44062071401586],[-73.64866923167948,45.44082056256033],[-73.64825833783733,45.44111520447436],[-73.64774015198448,45.44123368301964],[-73.64724049821064,45.44126879615556],[-73.64676333916724,45.44113844309118],[-73.6462748791722,45.44109080812004],[-73.64599582996333,45.44131524457949],[-73.64558227375566,45.44161108692514],[-73.64506907956772,45.44172941692876],[-73.6445552922927,45.44184787955032],[-73.64404092552986,45.44196647373383],[-73.64363635581779,45.44218047443491],[-73.6433415379772,45.44249028663933],[-73.64304608196883,45.44280076418638],[-73.64287308361281,45.44312389734817],[-73.64281041527991,45.44354377931859],[-73.64251344944273,45.44385647463682],[-73.6421050587483,45.4440734285386],[-73.64148754835631,45.44401336034585],[-73.64100611924279,45.44388093294653],[-73.64038797854339,45.443820802689],[-73.63986674131873,45.44394137264798],[-73.63934494510576,45.4440620678258],[-73.63882259643557,45.44418288587157],[-73.63840979251741,45.44440052560731],[-73.63798241530215,45.44470332026852],[-73.63755409503045,45.44500677949557],[-73.63724939554146,45.44532301917995],[-73.63694343877667,45.44563977818529],[-73.63665125511444,45.44587169313902],[-73.6363441241297,45.44618957821654],[-73.63603671280147,45.4465082819073],[-73.63572879401062,45.44682773628519],[-73.63519984291999,45.44695141230814],[-73.63467026340359,45.44707523633924],[-73.63436013718466,45.44739604261242],[-73.63428479239474,45.44782837275399],[-73.63397347507696,45.44815078893356],[-73.633661470443,45.44847391537346],[-73.63336415809485,45.44871064697936],[-73.63281467186545,45.44892338447633],[-73.63229537303754,45.44896155035831],[-73.6316498270393,45.44898745837357],[-73.63128784569508,45.4488633330398],[-73.63098767113414,45.44910030187852],[-73.6307968488556,45.44943684300269],[-73.63060661598729,45.44977640056042],[-73.63028876618768,45.45010295149473],[-73.62986022369222,45.45032986493149],[-73.62932114426985,45.45045690538667],[-73.62890804591801,45.450596768342],[-73.62847710480709,45.45082221141443],[-73.62828271891117,45.45116277968795],[-73.62819823811067,45.4516064888324],[-73.62840165716696,45.4518972515556],[-73.6284443564454,45.4523545979717],[-73.62813873412944,45.45259811901056],[-73.6275774309789,45.45281777845555],[-73.62727048480595,45.45306175492761],[-73.62707345689897,45.45340813078505],[-73.62700396739322,45.45376753956442],[-73.62667808688546,45.45410318858433],[-73.6261655628483,45.45405409443573],[-73.62561737947968,45.45418534455852],[-73.62517899380818,45.45441897564231],[-73.62485025115372,45.45475593558387],[-73.62452076464956,45.45509375201739],[-73.62395136054762,45.45531647459507],[-73.62339949875967,45.45544852833947],[-73.62284699346941,45.45558073249651],[-73.62264318288517,45.45593306069776],[-73.62256866332707,45.45629717980712],[-73.62249398534921,45.45666203139228],[-73.62216010311921,45.45700333823358],[-73.6217340393877,45.4571487793445],[-73.6211971326112,45.45718994293546],[-73.62065974258245,45.45723162647447],[-73.62012205017982,45.45727332193354],[-73.61967422477328,45.45751219762443],[-73.61946693045336,45.4578663894217],[-73.6193667183667,45.45833149218441],[-73.61928572219989,45.45870573697105],[-73.61883620014132,45.45894484872007],[-73.61831744004387,45.45889009083645],[-73.61777560539034,45.45893328379396],[-73.61732316558317,45.4591750178104],[-73.61722112726831,45.45964111613565],[-73.61713840540327,45.46001628498149],[-73.61703360869812,45.46048839408714],[-73.61668841414479,45.46083981851727],[-73.61614504199203,45.46087994660994],[-73.61546864391535,45.46090994893711],[-73.61494308848776,45.46086024780866],[-73.61476930351618,45.46103603634851],[-73.61439969305019,45.46148273911922],[-73.61429228336512,45.46195631168987],[-73.6138318038076,45.46220366316679],[-73.61315008912513,45.46223628636267],[-73.61280030891719,45.46258903743974],[-73.61244610203093,45.46294735476961],[-73.61185137865137,45.46318191549843],[-73.61127744081979,45.46332193628288],[-73.61094574465842,45.46358296046237],[-73.61059238867358,45.46393830382719],[-73.61036668528376,45.46431256600638],[-73.61014372683599,45.46468368196755],[-73.60965498289788,45.46502896314909],[-73.60918926799796,45.46527702984903],[-73.60860662994362,45.46542322140716],[-73.60839140637412,45.46578444047773],[-73.60817622705835,45.46614567540101],[-73.60796081936351,45.46650729104974],[-73.60760761940027,45.46686122622583],[-73.60710333759474,45.467222838804],[-73.60662248237736,45.46748649760971],[-73.60600328517057,45.46774133555262],[-73.60538313153842,45.46799601187412],[-73.60492821057967,45.46815710839828],[-73.60431286659201,45.46840459759029],[-73.6036962557361,45.46865259445729],[-73.60321526555823,45.46891190585027],[-73.60259630972139,45.46916089922038],[-73.60197957339577,45.46940677794962],[-73.60130660314404,45.46933911364424],[-73.60082199086914,45.46959980485554],[-73.60028412416837,45.47006049630554],[-73.60015480150524,45.47055849776631],[-73.60018789005166,45.47096989698128],[-73.59995605219748,45.47134896662593],[-73.59958102011464,45.47172258181781],[-73.59920516758508,45.47209701056968],[-73.59865924112395,45.47256657678628],[-73.59844245308132,45.47285709718809],[-73.59806195753235,45.47323619651597],[-73.5975168642868,45.47370450078026],[-73.597003634208,45.47406587035726],[-73.59662567342158,45.47444203339859],[-73.59610908585954,45.47480632225135],[-73.59561669127037,45.47507132959872],[-73.59520864394351,45.47555204591723],[-73.59457763823289,45.47580411316543],[-73.59394478394499,45.4760574166803],[-73.59354332050981,45.47645572604898],[-73.59317009625113,45.4767507990004],[-73.59262339309285,45.47714239615884],[-73.59221812109945,45.4775441152121],[-73.59195729724645,45.47795367618985],[-73.59171160367755,45.47834868029167],[-73.59143991350754,45.4788455030349],[-73.59133761685273,45.47925032743464],[-73.59123516936116,45.479655756657],[-73.59125148281517,45.48017152036795],[-73.59145224593064,45.48050463405761],[-73.59178408239757,45.48086083677806],[-73.59226271002422,45.48122399080751],[-73.59276346736435,45.48148982388904],[-73.59329780850324,45.4816450669943],[-73.5937995210719,45.48191131207116],[-73.59413365658611,45.48227034899552],[-73.59446903489248,45.48262919350866],[-73.59463328767858,45.48308559981509],[-73.59466121616529,45.48352503115235],[-73.59426882628019,45.48337718679576],[-73.59393300802863,45.48301691785122],[-73.59360009261557,45.4826544736893],[-73.59312615767911,45.48228106873015],[-73.59278912844321,45.48192602499286],[-73.59259492190324,45.48158219047629],[-73.5922916526365,45.48111827205191],[-73.59209486754521,45.48077936517132],[-73.59190022229235,45.48043899942962],[-73.59190598427826,45.47989943587934],[-73.5918381839943,45.47958709324545],[-73.59196555108885,45.47908085500878],[-73.59192327121961,45.47866824130846],[-73.59202495746264,45.47826449316153],[-73.59212847941704,45.47785938420916],[-73.59239113839352,45.47744797962329],[-73.59279596099195,45.47704659460516],[-73.59331273189375,45.47675969581293],[-73.59368573431107,45.47646464189829],[-73.59422135278741,45.47608297766127],[-73.59471538092404,45.47581730686233],[-73.59520864394351,45.47555204591723],[-73.59556361635019,45.4752740132087],[-73.5958072858824,45.47488182194378],[-73.59607810210116,45.47438818877648],[-73.59659619069893,45.47402268592101],[-73.5971118438923,45.47365929030792],[-73.59746234410775,45.47338530753217],[-73.59787088216613,45.4729043136435],[-73.59824450152344,45.47253276040465],[-73.59862003904155,45.47215926323383],[-73.59899675959706,45.47178453846805],[-73.59937405537914,45.47140921801316],[-73.5996165378081,45.47101977143267],[-73.59972211176701,45.47061885996978],[-73.59968927825051,45.47020840239028],[-73.5993076194094,45.47007086748384],[-73.59876539648633,45.47001887959883],[-73.59822315103486,45.46996688022764],[-73.59774006113791,45.47022353750803],[-73.59711576234501,45.47047182725841],[-73.5965968746523,45.47083576188849],[-73.59611030716817,45.47109456228991],[-73.59559267696245,45.47145680842372],[-73.59510168631446,45.47171898059808],[-73.5947459406752,45.47199502317375],[-73.59398094281073,45.47223123853542],[-73.59335327058317,45.47247927049278],[-73.59297141903274,45.47285401572395],[-73.59260759581463,45.47313631034867],[-73.5920762997141,45.47350860895855],[-73.5915776853421,45.4737753631707],[-73.59118699466337,45.47415762712321],[-73.59071696608547,45.47432208514491],[-73.59007953845939,45.47457588329165],[-73.58944099669704,45.47483011653185],[-73.58904640936268,45.47521494706467],[-73.58854333122498,45.47548381773216],[-73.58796226901325,45.47553284410777],[-73.58740762015442,45.47548162874448],[-73.58671396256263,45.47541777450303],[-73.58602337794015,45.47535138061012],[-73.58547151640018,45.47529776575831],[-73.58478243267469,45.4752301826554],[-73.5841690330545,45.47538208475913],[-73.58355493254807,45.47553415326446],[-73.58294013279868,45.47568639265761],[-73.58225055166606,45.47561820322409],[-73.58170020856781,45.47556273363867],[-73.58100579252073,45.47549796605787],[-73.5804556535352,45.47544234317499],[-73.57993287020781,45.47528710363814],[-73.57944680993266,45.47502619743984],[-73.57913136990327,45.47467653722191],[-73.5788164856356,45.47432748566239],[-73.57833110369477,45.47406844756024],[-73.5778456268613,45.47381015032804],[-73.57739412694723,45.47344967411306],[-73.57673850720103,45.4732812015621],[-73.57622659226033,45.47354719642131],[-73.5756541686472,45.4735889716001],[-73.57506877860854,45.47363834175333],[-73.57451576641618,45.47358601544212],[-73.57412939955431,45.47344766628103],[-73.57343108355903,45.47338621023988],[-73.57287744018876,45.4733341316257],[-73.57232372513641,45.47328205232155],[-73.57173628851746,45.47333169556895],[-73.57104605451404,45.47326534628515],[-73.57021772365918,45.47318571508465],[-73.56952856372989,45.47311871453891],[-73.5689422409587,45.47316711638643],[-73.56842946599807,45.47300970021141],[-73.56774326908906,45.47294122221668],[-73.5670557969416,45.47287337297607],[-73.56654572368265,45.47271516358722],[-73.56606385483967,45.47245917382589],[-73.56593474175752,45.47202464614504],[-73.56594438346647,45.47160392981268],[-73.56612794196683,45.47109607589421],[-73.56627439572263,45.4706908686361],[-73.56614598041638,45.47026034581302],[-73.5659812290061,45.46993157637935],[-73.56554332283609,45.46957687272464],[-73.56524479990293,45.46923515568518],[-73.56512002618975,45.46880712059452],[-73.56552866092993,45.46884708096935],[-73.56586384553776,45.4690876480642],[-73.56612697892436,45.46952920038625],[-73.5662916605991,45.46985724352492],[-73.56628311773031,45.47027353404464],[-73.56613725401601,45.4706775946644],[-73.56599071073217,45.47108275450165],[-73.56611852970462,45.47151557582923],[-73.56624665005349,45.47194941561954],[-73.56654944980232,45.47229549899123],[-73.56685686784793,45.47264012822325],[-73.56736789121122,45.47279778940883],[-73.56788050156962,45.47295492008914],[-73.56856671362435,45.47302339548798],[-73.5690795655488,45.47318080683196],[-73.56955880828905,45.47343998749734],[-73.56972703874392,45.47377533197452],[-73.5697216552864,45.4742008641032],[-73.56954203642711,45.4747172761079],[-73.56939795298128,45.47513151633711],[-73.5693921523194,45.4755603107461],[-73.56952513843214,45.47600370924551],[-73.56938051407202,45.47642096924375],[-73.56919924679642,45.47694394361045],[-73.56901743288317,45.47746848459161],[-73.56883643733266,45.47799383501684],[-73.5686529204111,45.47852182785996],[-73.56850811140404,45.47894394919008],[-73.5685034258182,45.47938056538271],[-73.56835810026813,45.47980467489668],[-73.5683532285356,45.4802433194776],[-73.56820738098206,45.48066944131983],[-73.56802458612248,45.48120350561612],[-73.56801930233944,45.48164546681602],[-73.56801400527854,45.48208847148195],[-73.56814729818504,45.48254823030108],[-73.56811946934621,45.48300860505128],[-73.56798366291672,45.48343351617215],[-73.56782675618302,45.4838735774565],[-73.56780935869666,45.4843302294976],[-73.56794616995394,45.4847936566641],[-73.567756555141,45.48534308630943],[-73.56778594923391,45.4856869321154],[-73.56767320357713,45.48601704563387],[-73.56748483447615,45.48656858034116],[-73.56719040098682,45.48699713258561],[-73.56689524241962,45.48742674307629],[-73.56659934245354,45.48785740631053],[-73.5664101803096,45.48841323657471],[-73.56654713303406,45.48888661080131],[-73.56666847884325,45.48937330747228],[-73.56698897522772,45.48975045993681],[-73.56731004062925,45.49012827594386],[-73.56744742798243,45.49060678793648],[-73.56747614691855,45.49096112199561],[-73.56746614138592,45.49142997740264],[-73.56741658642551,45.49201477011872],[-73.56722185032699,45.49258696632906],[-73.56702648531065,45.49316099750894],[-73.56683049037325,45.49373686875263],[-73.5666732363228,45.49419889980334],[-73.56647784140087,45.4947766246704],[-73.56632174630491,45.49523955592784],[-73.56612841215947,45.49581783387125],[-73.56612973985291,45.49628775512285]]}}]}");

/***/ }),

/***/ "./src/data/features.json":
/*!********************************!*\
  !*** ./src/data/features.json ***!
  \********************************/
/*! exports provided: features, type, default */
/***/ (function(module) {

module.exports = JSON.parse("{\"features\":[{\"type\":\"Feature\",\"properties\":{\"name\":\"Drowning\",\"theme\":\"Water\",\"id\":155,\"tag\":\"Dis/re-appearing Waters, Infrastructure, Unrully Waters\"},\"geometry\":{\"coordinates\":[-73.595,45.467781],\"type\":\"Point\"},\"id\":\"0dbf95544b9375bec51e333c9f71869c\"},{\"type\":\"Feature\",\"properties\":{\"name\":\"Falaise St. Jacques\",\"theme\":\"Environment, Steps\",\"id\":136},\"geometry\":{\"coordinates\":[[[-73.602983,45.469211],[-73.602573,45.469436],[-73.602316,45.469642],[-73.601932,45.46975],[-73.601419,45.470038],[-73.601522,45.469669],[-73.601573,45.469382],[-73.602803,45.46851],[-73.604521,45.467638],[-73.604944,45.46718],[-73.60552,45.467027],[-73.6062,45.466622],[-73.606738,45.466407],[-73.60784,45.465796],[-73.609275,45.465175],[-73.609724,45.464888],[-73.610147,45.464798],[-73.610544,45.464528],[-73.61139,45.464241],[-73.612261,45.463881],[-73.612659,45.463733],[-73.613056,45.463584],[-73.613722,45.463315],[-73.61576,45.462551],[-73.616491,45.462272],[-73.617759,45.461778],[-73.619067,45.461148],[-73.619566,45.460771],[-73.619861,45.460474],[-73.62022,45.460276],[-73.620528,45.460061],[-73.621015,45.459917],[-73.621438,45.459611],[-73.621566,45.459378],[-73.621796,45.459261],[-73.622937,45.458524],[-73.624142,45.457768],[-73.625269,45.456959],[-73.6265,45.456105],[-73.627909,45.454838],[-73.628448,45.454388],[-73.628678,45.45446],[-73.629563,45.453696],[-73.630242,45.453336],[-73.630421,45.453642],[-73.630216,45.453795],[-73.630191,45.454056],[-73.62996,45.454271],[-73.629358,45.454469],[-73.628794,45.455134],[-73.628781,45.455368],[-73.628281,45.45553],[-73.627833,45.456006],[-73.627499,45.456258],[-73.626795,45.456654],[-73.626243,45.457148],[-73.62568,45.457732],[-73.625321,45.457867],[-73.625116,45.458362],[-73.625487,45.458631],[-73.625128,45.459135],[-73.624577,45.458874],[-73.623719,45.45953],[-73.622591,45.459782],[-73.621758,45.461014],[-73.620656,45.461364],[-73.620156,45.461589],[-73.619387,45.461912],[-73.618977,45.462137],[-73.602983,45.469211]]],\"type\":\"Polygon\"},\"id\":\"31f219523dab517791fd662df84ad922\"},{\"type\":\"Feature\",\"properties\":{\"name\":\"Overflow: The Flood of 1904\",\"theme\":\"Water\",\"id\":153,\"tag\":\"Unrully Waters, Infrastructure, Imaginaries\"},\"geometry\":{\"coordinates\":[-73.565131,45.473318],\"type\":\"Point\"},\"id\":\"35949d66c4db57ddc6f28c7881791782\"},{\"type\":\"Feature\",\"properties\":{\"name\":\"Pointe-à-Callière\",\"theme\":\"Environment\",\"id\":132,\"tag\":\"Ghosts, Imaginaries, Unrully Waters\"},\"geometry\":{\"coordinates\":[-73.554216,45.502389],\"type\":\"Point\"},\"id\":\"665f2139a4fe406260ef21b0079a0dda\"},{\"type\":\"Feature\",\"properties\":{\"name\":\"A Ghost Story\",\"theme\":\"Water, Environment\",\"id\":151,\"tag\":\"Speculation, Ghosts\"},\"geometry\":{\"coordinates\":[-73.554082,45.502794],\"type\":\"Point\"},\"id\":\"b856be5a37e64e52c4d0ccce51c2fd29\"},{\"type\":\"Feature\",\"properties\":{\"name\":\"Water Out of Place\",\"theme\":\"Water\",\"id\":172,\"tag\":\"Infrastructure, Unrully Waters, Imaginaries\"},\"geometry\":{\"coordinates\":[-73.543169,45.50587],\"type\":\"Point\"},\"id\":\"db8f697bf3d9d039ac3246e8feaf805d\"},{\"type\":\"Feature\",\"properties\":{\"name\":\"The Tailrace\",\"theme\":\"Water, Environment\",\"id\":180,\"tag\":\"Contamination, Dis/re-appearing Waters, Infrastructure\"},\"geometry\":{\"coordinates\":[[-73.568712,45.474668],[-73.564047,45.473014],[-73.559203,45.471217],[-73.556537,45.469886]],\"type\":\"LineString\"},\"id\":\"e2f0361ab20a10bb589628d7e11470f5\"}],\"type\":\"FeatureCollection\"}");

/***/ }),

/***/ "./src/datavis.js":
/*!************************!*\
  !*** ./src/datavis.js ***!
  \************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! d3/dist/d3.min */ "./node_modules/d3/dist/d3.min.js");
/* harmony import */ var d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _mapAPI_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./mapAPI.js */ "./src/mapAPI.js");
/* harmony import */ var _wordpress_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./wordpress.js */ "./src/wordpress.js");
/* harmony import */ var _data_features_json__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./data/features.json */ "./src/data/features.json");
var _data_features_json__WEBPACK_IMPORTED_MODULE_3___namespace = /*#__PURE__*/__webpack_require__.t(/*! ./data/features.json */ "./src/data/features.json", 1);
/* harmony import */ var _data_1834_A_Jobin_final_2_json__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./data/1834_A_Jobin_final-2.json */ "./src/data/1834_A_Jobin_final-2.json");
var _data_1834_A_Jobin_final_2_json__WEBPACK_IMPORTED_MODULE_4___namespace = /*#__PURE__*/__webpack_require__.t(/*! ./data/1834_A_Jobin_final-2.json */ "./src/data/1834_A_Jobin_final-2.json", 1);
/* harmony import */ var _config_config_json__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./config/config.json */ "./src/config/config.json");
var _config_config_json__WEBPACK_IMPORTED_MODULE_5___namespace = /*#__PURE__*/__webpack_require__.t(/*! ./config/config.json */ "./src/config/config.json", 1);
// import * as d3 from 'd3';









const internalOption = {
	passThrough: true,
};

let D3geoPath;
let svg;
let riverLines;
let dataset = [];
let nodesPoint;
let nodesLine;
let nodesPoygon;

// const dataURL = 'https://api.mapbox.com/datasets/v1/saintpierremapping/cjxdpkggs01gi2os0srxdx837?access_token=pk.eyJ1Ijoic2FpbnRwaWVycmVtYXBwaW5nIiwiYSI6ImNqdDBpOXo4aDBkYmk0Nm5wMTU0MzhxcWcifQ.tH1TZXEMh4KOnahRKRl_BA';
// const dataURL = `https://api.mapbox.com/datasets/v1/${config.mapbox.user}/cjxdpkggs01gi2os0srxdx837/features?access_token=pk.eyJ1Ijoic2FpbnRwaWVycmVtYXBwaW5nIiwiYSI6ImNqdDBpOXo4aDBkYmk0Nm5wMTU0MzhxcWcifQ.tH1TZXEMh4KOnahRKRl_BA`

// const loadData = async () => {
// 	const response = await fetch(dataURL);
// 	const data = await response.json();
// 	console.log(data);
// };
// loadData();

const init = canvas => {

	const D3geoTransform = Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_0__["geoTransform"])({point:_mapAPI_js__WEBPACK_IMPORTED_MODULE_1__["default"].projectPoint});
	D3geoPath = Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_0__["geoPath"])().projection(D3geoTransform);

	dataset = _data_features_json__WEBPACK_IMPORTED_MODULE_3__.features;

	// Overlay d3 on the mapbox canvas
	svg = Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_0__["select"])(canvas).append('svg');
	svg.attr('id', 'map-box-vis');

	svg.attr('height', '100%');

	drawRiver(_data_1834_A_Jobin_final_2_json__WEBPACK_IMPORTED_MODULE_4__.features, 500, 2);

};

const getThemeNodes = theme => {
	const selectedNodes = [];
	for (const node of dataset) {
		const nodethemes = node.properties.theme.split(', ');
		const themeNode = nodethemes.filter(t => t.toLowerCase() === theme);
		if (themeNode.length > 0) selectedNodes.push(node);
	}
	return selectedNodes;
};

const drawNodes = ({slug: theme}) => {

	const themeNodes = getThemeNodes(theme);
	const points = themeNodes.filter(n => n.geometry.type === 'Point');
	const lines = themeNodes.filter(n => n.geometry.type === 'LineString');
	const polygons = themeNodes.filter(n => n.geometry.type === 'Polygon');
	// console.log(themeNodes,points,lines,polygons);

	drawPoints({data:points});
	drawLines({data:lines});
	drawPolygins({data:polygons});

};

const drawPoints =  ({data, transitionTime = 5000, delayTime = 1000}) => {

	// Add circles
	nodesPoint = svg.selectAll('.circle')
		.data(data);

	nodesPoint.exit()
		.attr('id', 'exit')
		.attr('class', 'exit')
		.transition()
		.duration(500)
		.style('fill', '#000000')
		.attr('r', 0)
		.remove();

	nodesPoint.enter().append('circle')
		.attr('class', 'circle');

	nodesPoint = svg.selectAll('.circle')
		.attr('id', function (d) {
			return `index-${d.properties.id}`;
		})
		.on('click', function (d) {
			_wordpress_js__WEBPACK_IMPORTED_MODULE_2__["default"].showPost(d.properties);
		})
		// .on('mouseover', function (d) {
		// 	// _this._mouseOverSelection(d);
		// 	console.log(d.properties);
		// })
		// .on('mouseout', function (d) {
		// 	// _this._mouseOutSelection(d);
		// 	// console.log(d);
		// })
		.attr('cx', function (d) {
			return _mapAPI_js__WEBPACK_IMPORTED_MODULE_1__["default"].project(d.geometry.coordinates).x;
		})
		.attr('cy', function (d) {
			return _mapAPI_js__WEBPACK_IMPORTED_MODULE_1__["default"].project(d.geometry.coordinates).y;
		})
		.attr('r', 0)
		.style('opacity', 0.1);
	// .style('fill', )
	// .style('stroke', );
		
	nodesPoint.transition()
		.duration(transitionTime)
		.delay(function (d, i) {
			return delayTime * i;
		})
		.attr('r', 8)
		.style('opacity', 0.8);
};

const drawLines =  ({data, transitionTime = 5000, delayTime = 1000}) => {

	// Add circles
	nodesLine = svg.selectAll('.line')
		.data(data);

	nodesLine.exit()
		.attr('id', 'exit')
		.attr('class', 'exit')
		.transition()
		.duration(500)
		.style('fill', '#000000')
		.attr('width', 0)
		.remove();

	nodesLine.enter().append('path')
		.attr('class', 'line');

	nodesLine = svg.selectAll('.line')
		.attr('id', function (d) {
			return d.properties.id;
		})
		.attr('d', D3geoPath)
		// .on('mouseover', function (d) {
		// 	// console.log(d);
		// })
		// .on('mouseout', function (d) {
		// 	// console.log(d);
		// })
		.on('click', function (d) {
			_wordpress_js__WEBPACK_IMPORTED_MODULE_2__["default"].showPost(d.properties);
		})
		.style('cursor', 'pointer')
		.style('fill','none')
		.style('stroke-width', 0)
		.style('stroke', '#FF8C00')
		.style('opacity', 0.1);


	nodesLine.transition()
		.duration(transitionTime)
		.delay(function (d, i) {
			return delayTime * i;
		})
		.style('stroke-width', 2)
		.style('opacity', 0.8);


};

const drawPolygins =  ({data, transitionTime = 5000, delayTime = 1000}) => {

	// Add circles
	nodesPoygon = svg.selectAll('.polygons')
		.data(data);

	nodesPoygon.exit()
		.attr('id', 'exit')
		.attr('class', 'exit')
		.transition()
		.duration(500)
		.style('fill', '#000000')
		.attr('width', 0)
		.remove();

	nodesPoygon.enter().append('path')
		.attr('class', 'polygons');

	nodesPoygon = svg.selectAll('.polygons')
		.attr('id', function (d) {
			return d.properties.id;
		})
		.attr('d', D3geoPath)
		// .on('mouseover', function (d) {
		// 	// console.log(d);
		// })
		// .on('mouseout', function (d) {
		// 	// console.log(d);
		// })
		.on('click', function (d) {
			_wordpress_js__WEBPACK_IMPORTED_MODULE_2__["default"].showPost(d.properties);
		})
		.style('cursor', 'pointer')
		.style('fill','#FFA500')
		.style('stroke-width', 0)
		.style('stroke', '#FF8C00')
		.style('opacity', 0.1);


	nodesPoygon.transition()
		.duration(transitionTime)
		.delay(function (d, i) {
			return delayTime * i;
		})
		.style('stroke-width', 2)
		.style('opacity', 0.8);

};

const drawRiver = data => {

	riverLines = svg.selectAll('#river')
		.data(data)
		.enter()
		.append('path')
		.attr('id', 'river')
		.attr('d', D3geoPath)
		.style('fill','none')
		.style('stroke-width', 1)
		.style('stroke', '#0071bc')
		.style('opacity', 0.8);

	// riverLines.transition()
	// 	.duration(1000)
	// 	.style('stroke-width', 4)
	// 	.style('opacity', 0.8);

	//graph animation
	let lineLength = riverLines.node().getTotalLength();

	riverLines
		.attr('stroke-dasharray', lineLength + ' ' + lineLength)
		.attr('stroke-dashoffset', +lineLength)
		.transition()
		.duration(8000)
		.ease(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_0__["easeLinear"])
		.attr('stroke-dashoffset', 0)
		.style('stroke-width', 3)
		.on('end', () => {
			if(!internalOption.passThrough) _mapAPI_js__WEBPACK_IMPORTED_MODULE_1__["default"].pitchMap({finalPitch:40, duration:2000});
		});
};

const mapUpdate =  () => {
	riverUpdate();
	nodeUpdate();
};

const riverUpdate = () => {
	if (riverLines) {
		riverLines
			.attr('d', D3geoPath)
			.attr('stroke-dasharray', 'none')
			.attr('stroke-dashoffset', 'none');
	}
};

const nodeUpdate = () => {
	
	if (nodesPoint) {
		nodesPoint
			.attr('cx', function (d) {
				return _mapAPI_js__WEBPACK_IMPORTED_MODULE_1__["default"].project(d.geometry.coordinates).x;
			})
			.attr('cy', function (d) {
				return _mapAPI_js__WEBPACK_IMPORTED_MODULE_1__["default"].project(d.geometry.coordinates).y;
			});
	}

	if (nodesLine) nodesLine.attr('d', D3geoPath);
	if (nodesPoygon) nodesPoygon.attr('d', D3geoPath);
	
};



/* harmony default export */ __webpack_exports__["default"] = ({
	init,
	drawNodes,
	mapUpdate
});

/***/ }),

/***/ "./src/mapAPI.js":
/*!***********************!*\
  !*** ./src/mapAPI.js ***!
  \***********************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! d3/dist/d3.min */ "./node_modules/d3/dist/d3.min.js");
/* harmony import */ var d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var mapbox_gl__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! mapbox-gl */ "./node_modules/mapbox-gl/dist/mapbox-gl.js");
/* harmony import */ var mapbox_gl__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(mapbox_gl__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _config_config_json__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./config/config.json */ "./src/config/config.json");
var _config_config_json__WEBPACK_IMPORTED_MODULE_2___namespace = /*#__PURE__*/__webpack_require__.t(/*! ./config/config.json */ "./src/config/config.json", 1);
/* harmony import */ var _datavis_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./datavis.js */ "./src/datavis.js");


// import 'mapbox-gl/dist/mapbox-gl.css'



const internalOption = {
	mousePitch: false
};

mapbox_gl__WEBPACK_IMPORTED_MODULE_1___default.a.accessToken = _config_config_json__WEBPACK_IMPORTED_MODULE_2__.mapbox.token;
let mapbox;
const bounds = [
	[-73.81,45.35],
	[-73.34,45.58]
];

let pitchAnimation;

const mapBoxConfig = {
	container: 'map',
	style: `mapbox://styles/${_config_config_json__WEBPACK_IMPORTED_MODULE_2__.mapbox.user}/cjxzbs7nf0a4b1cowp80tsndy`,
	center: [-73.56, 45.465], //center in Montreal
	zoom: 11.5,
	pitch: 0,
	interactive: true,
	// maxZoom: 17,
	maxBounds: null//bounds // Sets bounds as max
};

const init = async ({mapID, notFound}) => {

	return new Promise(resolve => {

		if (mapID) mapBoxConfig.style = `mapbox://styles/${_config_config_json__WEBPACK_IMPORTED_MODULE_2__.mapbox.user}/${mapID}`;
		if (notFound) {

			const lat = Math.floor(Math.random() * 180) - 90;
			const lon = Math.floor(Math.random() * 360) - 180;

			mapBoxConfig.zoom = 5;
			mapBoxConfig.center = [lon,lat];
			// delete mapBoxConfig.maxBounds;
		}

		console.log(mapBoxConfig);
		const mapContainer = Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_0__["select"])('#app').select(':first-child').append('div'); //map container set on WP > Beaver
		mapContainer.attr('id', 'map');

		mapbox = new mapbox_gl__WEBPACK_IMPORTED_MODULE_1___default.a.Map(mapBoxConfig);
		// const canvas = mapbox.getCanvasContainer();
		
		mapbox.on('viewreset', update);
		mapbox.on('move', update);
		mapbox.on('moveend', update);


		mapbox.on('load', () => {
			// pitchMap();

			_datavis_js__WEBPACK_IMPORTED_MODULE_3__["default"].init(mapbox.getCanvasContainer());
			if(internalOption.mousePitch) mouseMapPitch();
			
			if (notFound) {
				mapbox.flyTo({
					center: [-73.56, 45.465],
					zoom: 11.5,
					speed: 1,
					curve: 1,
					minZoom: 3,
					// pitch: 60,
					macBounds: bounds,
					// maxDuration: 5000,
					easing: function (t) { return t; }
				});

				mapbox.on('moveend', () => {
					if (mapbox.getMaxBounds() == null) mapbox.setMaxBounds(bounds);
				});
				// mapbox.setMaxBounds = bounds;
			}
			

			resolve();
		});
	});

};


const isMapboxLoaded = () =>  {
	if (mapbox) return mapbox.isStyleLoaded();
	return false;
};

const pitchMap = ({finalPitch = 0, duration = 1000}) => {

	if (pitchAnimation) clearInterval(pitchAnimation);

	const tick = 10;
	let elapse = 0;

	const scalePitch = Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_0__["scaleLinear"])()
		.domain([0, duration])
		.range([mapbox.getPitch(), finalPitch]);

	// const scaleZoom = scaleLinear()
	// 	.domain([0, max])
	// 	.range([11.5, 12]);

	pitchAnimation = setInterval( () => {
		mapbox.setPitch(scalePitch(elapse));
		// mapbox.setZoom(scaleZoom(elapse));
		elapse += tick;
		if (elapse > duration) {
			clearInterval(pitchAnimation);
			pitchAnimation = null;
		}
	}, tick);

};

const mouseMapPitch = () => {
	const _scale = Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_0__["scaleLinear"])()
		.domain([0, window.innerWidth])
		.range([0, 60]);

	Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_0__["select"])('#map').on('mousemove', function() {
		const _mouse = Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_0__["mouse"])(this);
		console.log(_mouse[0], _scale(_mouse[0]));
		mapbox.setPitch(_scale(_mouse[0]));
	});
};

const update = () => _datavis_js__WEBPACK_IMPORTED_MODULE_3__["default"].mapUpdate();

// Project GeoJSON coordinate to the map's current state
const project = d => mapbox.project(new mapbox_gl__WEBPACK_IMPORTED_MODULE_1___default.a.LngLat(+d[0], +d[1]));

// Project GeoJSON coordinate to the map's current state
const projectPoint = function (lon, lat) {
	let point = mapbox.project(new mapbox_gl__WEBPACK_IMPORTED_MODULE_1___default.a.LngLat(lon, lat));
	this.stream.point(point.x, point.y);
};

const changeMap = ({mapID}) => {
	mapbox.setStyle(`mapbox://styles/${_config_config_json__WEBPACK_IMPORTED_MODULE_2__.mapbox.user}/${mapID}`);
	pitchMap({finalPitch:0, duration:1});
};


/* harmony default export */ __webpack_exports__["default"] = ({
	init,
	update,
	project,
	projectPoint,
	changeMap,
	pitchMap,
	isMapboxLoaded
});


/***/ }),

/***/ "./src/wordpress.js":
/*!**************************!*\
  !*** ./src/wordpress.js ***!
  \**************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var wpapi__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! wpapi */ "./node_modules/wpapi/wpapi.js");
/* harmony import */ var wpapi__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(wpapi__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! d3/dist/d3.min */ "./node_modules/d3/dist/d3.min.js");
/* harmony import */ var d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _mapAPI_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./mapAPI.js */ "./src/mapAPI.js");
/* harmony import */ var _datavis_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./datavis.js */ "./src/datavis.js");
/* harmony import */ var _config_config_json__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./config/config.json */ "./src/config/config.json");
var _config_config_json__WEBPACK_IMPORTED_MODULE_4___namespace = /*#__PURE__*/__webpack_require__.t(/*! ./config/config.json */ "./src/config/config.json", 1);






const wp = new wpapi__WEBPACK_IMPORTED_MODULE_0___default.a({
	endpoint: _config_config_json__WEBPACK_IMPORTED_MODULE_4__.wordpress.remote.endpoint
});

const internalOption = {
	animation: {
		duration: {
			in: 3000,
			out: 2000
		}
	},
	mainMenu: false,
	topMenu: false,
};

const themes = [
	{
		id: 0,
		slug: 'home',
		mapID: 'cjxzbs7nf0a4b1cowp80tsndy',
		state: 'home'
	},
	{
		id: 56,
		slug: 'about',
		mapID: 'cjybs9tuv1gnl1clpln0s5vq9',
		state: 'page'
	},
	{
		id: 114,
		slug: 'environment',
		mapID: 'cjtf3qpso03kh1fkvzo8dd4xk',
		state: 'page'
	},
	{
		id: 118,
		slug: 'steps',
		mapID: 'cjtg0c42v0w5x1fqlf1rmfs76',
		state: 'page'
	},
	{
		id: 116,
		slug: 'water',
		mapID: 'cjuee51b92imr1fpof8u119ws',
		state: 'page'
	}
];

let theme = themes[0];

const getThemeBySlug = slug => themes.find( theme => theme.slug === slug );

const initHome = ({notFound}) => {

	Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["select"])('#home-text')
		.style('opacity', 0)
		.style('display', 'block')
		.transition()
		.delay(0) //3000
		.duration(0)
		// .duration(internalOption.animation.duration.in)
		.style('opacity', 1);

	let delay = 0; //8000
	
	for (const theme of themes) {

		Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["select"])(`#main-${theme.slug}-bt`)
			.style('opacity', 0)
			.style('display', 'block')
			.transition()
			.delay(delay)
			.duration(internalOption.animation.duration.in)
			.style('opacity', 1);

		delay += 1000;
	}

	configMainMenu();
	updateMap({notFound});
};

const configMainMenu = () => {
	if (internalOption.mainMenu == false) {
		for (const theme of themes) {
			Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["select"])(`#main-${theme.slug}-bt`)
				.on('click', () => showPage(theme));
		}
		internalOption.mainMenu = true;
	}
};

const configTopMenu = () => {
	if (internalOption.topMenu == false) {
		for (const theme of themes) {
			Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["select"])(`#top-${theme.slug}-bt`)
				.on('click', () => showPage(theme))
				.style('cursor', 'pointer'); 
		}
		internalOption.topMenu = true;
	}
};


const showHome = () => {

	Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["select"])('#header-col')
		.style('display', 'block')
		.transition()
		.delay(1000)
		.duration(3000)
		.style('opacity', 1)
		.style('margin-top', '0px');

	Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["selectAll"])('.col-main-menu')
		.style('opacity', 0)
		.style('display', 'block')
		.transition()
		.delay(1000)
		.duration(3000)
		.style('opacity', 1)
		.style('margin-top', '0px');

	Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["select"])('#home-text')
		.style('display', 'block')
		.style('opacity', 1);

	for (const theme of themes) {
		Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["select"])(`#main-${theme.slug}-bt`)
			.style('display', 'block')
			.style('opacity', 1);
	}

	configMainMenu();
};

const hideHome = () => {
	Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["select"])('#header-col')
		.transition()
		.duration(3000)
		.style('opacity', 0)
		.style('margin-top', '-500px')
		.on('end', function () {
			Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["select"])(this).style('display', 'none');
		});

	Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["selectAll"])('.col-main-menu')
		.transition()
		.duration(3000)
		.style('opacity', 0)
		.style('margin-top', '-200px')
		.on('end', function () {
			Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["select"])(this).style('display', 'none');
		});
};

const showTopMenu = () => {
	Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["select"])('#top-menu')
		.style('opacity', 0)
		.style('top', -200)
		.style('display', 'block')
		.transition()
		.delay(3000)
		.duration(2000)
		.style('opacity', 1)
		.style('top', 0);

	configTopMenu();
};

const hideTopMenu = () => {
	Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["select"])('#top-menu')
		.transition()
		.delay(0)
		.duration(2000)
		.style('opacity', 0)
		.style('top', -200)
		.on('end', function () {
			Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["select"])(this).style('display', 'none');
		});
};

const showPanel = ({direction = 'none', delay = 0}) => {

	if (direction == 'none') {
		direction = '0px';
	} else if (direction == 'up') {
		direction = '-2000px';
	} else if (direction == 'down') {
		direction = '2000px';
	}

	Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["select"])('#left-panel')
		.style('opacity', 0)
		.style('margin-top', direction)
		.style('display', 'block')
		.transition()
		.delay(delay)
		.duration(internalOption.animation.duration.in)
		.style('opacity', 0)
		.style('margin-top', '0px');

	Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["select"])('#middle-panel')
		.style('opacity', 0)
		.style('margin-top', direction)
		.style('display', 'block')
		.transition()
		.delay(delay)
		.duration(internalOption.animation.duration.in)
		.style('opacity', 0)
		.style('margin-top', '0px');

	Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["select"])('#right-panel')
		.style('opacity', 0)
		.style('margin-top', direction)
		.style('display', 'block')
		.transition()
		.delay(delay)
		.duration(internalOption.animation.duration.in)
		.style('opacity', 1)
		.style('margin-top', '0px');

	Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["select"])('#right-panel').select('.fl-col-content').property('scrollTop', 0);
};

const hidePanel = async ({direction = 'none'}) => {

	return new Promise(resolve => {

		if (direction == 'none') {
			direction = '0px';
		} else if (direction == 'up') {
			direction = '-2000px';
		} else if (direction == 'down') {
			direction = '2000px';
		}

	
		Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["select"])('#left-panel')
			.transition()
			.delay(0)
			.duration(internalOption.animation.duration.out)
			.style('opacity', 0)
			.style('margin-top', direction)
			.on('end', function () {
				Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["select"])(this).style('display', 'none');
			});

		Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["select"])('#middle-panel')
			.transition()
			.delay(0)
			.duration(internalOption.animation.duration.out)
			.style('opacity', 0)
			.style('margin-top', direction)
			.on('end', function () {
				Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["select"])(this).style('display', 'none');
			});

		Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["select"])('#right-panel')
			.transition()
			.delay(0)
			.duration(internalOption.animation.duration.out)
			.style('opacity', 0)
			.style('margin-top', direction)
			.on('end', function () {
				Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["select"])(this).style('display', 'none');
				resolve();
			});
	});
};


const showPost = async ({id, slug}) => {

	//postData - load by ID or by Slug
	const postData = await loadPost({id,slug});
	// console.log(postData);
	if (!postData) return;

	const postCategories = postData._embedded['wp:term'][0];
	const postTags = postData._embedded['wp:term'][1];

	// const postTheme = postCategories[0].slug;
	let postTheme = postCategories.find(cat => cat.slug == theme.slug);

	if (!postTheme) postTheme = postCategories[0];
	
	if(postTheme.slug == 'uncategorized') console.log('Problem with category "uncategorized": ', postData);

	setTheme(postTheme.slug);
	if (theme.isNew) updateMap(theme);
	
	await hidePanel({direction: 'up'});

	updatePost(postData,postTags);

	//show Panel
	showPanel({direction: 'down', delay: 0});

	changeBrowserHistory({
		title: postData.title.rendered,
		slug: postData.slug
	});

	return {
		post: postData,
		theme: postTheme
	};

};

const loadPost = async ({id, slug}) => {

	let postData;

	if (id) {
		postData = await wp.posts().id(id).embed();
	} else if (slug) {
		postData = await wp.posts().slug(slug).embed();
		postData = postData[0];
	}

	return postData;
};

const updatePost = ({title, content}, tags) => {
	//DOM manipulation
	const panel = Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["select"])('#right-panel');

	panel.select('#article-title').select('.fl-heading-text').html(title.rendered);
	panel.select('#article-content').select('.fl-rich-text').html(content.rendered);
	panel.select('.tagline').select('.fl-heading-text').html(theme.slug);

	//tags
	const tagsDIV = panel.select('#article-tags').select('.fl-html');
	let tagsHTML = '<div id="tag-container">';
	for (const tag of tags) {
		tagsHTML += `<div id="tag-${tag.slug}" class="tag-pill">${tag.name}</div>`;
	}
	tagsHTML += '</div>';

	tagsDIV.html(tagsHTML);

	captureLinks();
};

const showPage = async ({id, slug}) => {

	await setTheme(slug);

	if (theme.isNew) updateMap(theme);

	if (id == 0) {
		changeBrowserHistory({slug: '/ghost-river/'});
		return;
	}
		
	const pageData = await loadPage({id, slug});
	// console.log(pageData);
	
	updatePage(pageData);
	
	//show panel
	showPanel({direction: 'down', delay: 0});

	changeBrowserHistory({
		title: pageData.title.rendered,
		slug: pageData.slug
	});

	return pageData;
	
};

const setTheme = async requestedThemeSlug => {

	theme.isNew = false;
	
	if(theme.slug != requestedThemeSlug) {
		const requestedTheme = getThemeBySlug(requestedThemeSlug);
		changeState(requestedTheme.state);
		theme = requestedTheme;
		theme.isNew = true;
	}

	if (theme.slug != 'home') await hidePanel({direction: 'up'});
	
	return theme;
};

const updateMap = async ({notFound}) => {

	if(!_mapAPI_js__WEBPACK_IMPORTED_MODULE_2__["default"].isMapboxLoaded()) {
		if (notFound == true) {
			await _mapAPI_js__WEBPACK_IMPORTED_MODULE_2__["default"].init({notFound});
		} else {
			await _mapAPI_js__WEBPACK_IMPORTED_MODULE_2__["default"].init(theme);
		}
		
	} else {
		await _mapAPI_js__WEBPACK_IMPORTED_MODULE_2__["default"].changeMap(theme);
	}

	_datavis_js__WEBPACK_IMPORTED_MODULE_3__["default"].drawNodes(theme);
};


const changeState = newState => {

	if (newState != theme.state) {
		if (newState === 'home') {
			hideTopMenu();
			hidePanel({direction: 'up'});
			showHome();
		} else if (newState === 'page') {
			hideHome();
			showTopMenu();
		}
	}
	
};

const loadPage = async ({id, slug}) => {
	let pageData;

	if (id) {
		pageData = await wp.pages().id(id).embed();
	} else if (slug) {
		pageData = await wp.pages().slug(slug).embed();
		pageData = pageData[0];
	}

	return pageData;
};

const updatePage = ({title, content}) => {
	//dom manipulation
	Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["select"])('#right-panel').select('#article-title').select('.fl-heading-text').html(title.rendered);
	Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["select"])('#right-panel').select('#article-content').select('.fl-rich-text').html(content.rendered);
	Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["select"])('#right-panel').select('.tagline').select('.fl-heading-text').html('');
	Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["select"])('#right-panel').select('#article-tags').select('.fl-html').html('');
	captureLinks();
};

const captureLinks = () => {
	Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["selectAll"])('a')
		.on('click', function () {

			//get url // domain
			const link = Object(d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["select"])(this).attr('href');
			const domain = link.split('/')[2];

			//Test if it is a local link (localhost -> remote)
			const host = (window.location.hostname == 'localhost') ? 'labs.fluxo.art.br' : window.location.hostname;

			//if extrrnal, navigate
			if (domain != host) return; //window.location.hostname

			//if local, prevent page update
			d3_dist_d3_min__WEBPACK_IMPORTED_MODULE_1__["event"].preventDefault();

			//load post based on slug on the url
			const slug = link.split('/')[4];

			showPost({slug});
		});

};

const changeBrowserHistory = ({title,slug}) => {

	let pageTitle = 'Ghost River';
	if (title) pageTitle += ` - ${title}`;

	document.title = pageTitle;
	window.history.pushState(
		{pageTitle},
		'',
		slug);
};

/* harmony default export */ __webpack_exports__["default"] = ({
	initHome,
	showPost,
	showPage,
	loadPage,
	changeBrowserHistory,
	getThemeBySlug
});

/***/ })

/******/ });
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2FwcC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvZGF0YXZpcy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvbWFwQVBJLmpzIiwid2VicGFjazovLy8uL3NyYy93b3JkcHJlc3MuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsZ0JBQVEsb0JBQW9CO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQWlCLDRCQUE0QjtBQUM3QztBQUNBO0FBQ0EsMEJBQWtCLDJCQUEyQjtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOzs7QUFHQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0Esa0RBQTBDLGdDQUFnQztBQUMxRTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGdFQUF3RCxrQkFBa0I7QUFDMUU7QUFDQSx5REFBaUQsY0FBYztBQUMvRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaURBQXlDLGlDQUFpQztBQUMxRSx3SEFBZ0gsbUJBQW1CLEVBQUU7QUFDckk7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBMkIsMEJBQTBCLEVB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O0FBRUE7QUFDQSw4QkFBOEI7O0FBRTlCO0FBQ0EsR0FBRyxvREFBSzs7QUFFUjtBQUNBOztBQUVBLGFBQWEsS0FBSztBQUNsQixHQUFHOztBQUVIOztBQUVBLCtCQUErQixXQUFXOztBQUUxQztBQUNBLCtCQUErQixNQUFNOztBQUVyQztBQUNBO0FBQ0EsR0FBRyxVQUFVO0FBQ2I7QUFDQTtBQUNBOztBQUVlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxFIiwiZmlsZSI6ImFwcC5idW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBpbnN0YWxsIGEgSlNPTlAgY2FsbGJhY2sgZm9yIGNodW5rIGxvYWRpbmdcbiBcdGZ1bmN0aW9uIHdlYnBhY2tKc29ucENhbGxiYWNrKGRhdGEpIHtcbiBcdFx0dmFyIGNodW5rSWRzID0gZGF0YVswXTtcbiBcdFx0dmFyIG1vcmVNb2R1bGVzID0gZGF0YVsxXTtcbiBcdFx0dmFyIGV4ZWN1dGVNb2R1bGVzID0gZGF0YVsyXTtcblxuIFx0XHQvLyBhZGQgXCJtb3JlTW9kdWxlc1wiIHRvIHRoZSBtb2R1bGVzIG9iamVjdCxcbiBcdFx0Ly8gdGhlbiBmbGFnIGFsbCBcImNodW5rSWRzXCIgYXMgbG9hZGVkIGFuZCBmaXJlIGNhbGxiYWNrXG4gXHRcdHZhciBtb2R1bGVJZCwgY2h1bmtJZCwgaSA9IDAsIHJlc29sdmVzID0gW107XG4gXHRcdGZvcig7aSA8IGNodW5rSWRzLmxlbmd0aDsgaSsrKSB7XG4gXHRcdFx0Y2h1bmtJZCA9IGNodW5rSWRzW2ldO1xuIFx0XHRcdGlmKGluc3RhbGxlZENodW5rc1tjaHVua0lkXSkge1xuIFx0XHRcdFx0cmVzb2x2ZXMucHVzaChpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF1bMF0pO1xuIFx0XHRcdH1cbiBcdFx0XHRpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gPSAwO1xuIFx0XHR9XG4gXHRcdGZvcihtb2R1bGVJZCBpbiBtb3JlTW9kdWxlcykge1xuIFx0XHRcdGlmKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtb3JlTW9kdWxlcywgbW9kdWxlSWQpKSB7XG4gXHRcdFx0XHRtb2R1bGVzW21vZHVsZUlkXSA9IG1vcmVNb2R1bGVzW21vZHVsZUlkXTtcbiBcdFx0XHR9XG4gXHRcdH1cbiBcdFx0aWYocGFyZW50SnNvbnBGdW5jdGlvbikgcGFyZW50SnNvbnBGdW5jdGlvbihkYXRhKTtcblxuIFx0XHR3aGlsZShyZXNvbHZlcy5sZW5ndGgpIHtcbiBcdFx0XHRyZXNvbHZlcy5zaGlmdCgpKCk7XG4gXHRcdH1cblxuIFx0XHQvLyBhZGQgZW50cnkgbW9kdWxlcyBmcm9tIGxvYWRlZCBjaHVuayB0byBkZWZlcnJlZCBsaXN0XG4gXHRcdGRlZmVycmVkTW9kdWxlcy5wdXNoLmFwcGx5KGRlZmVycmVkTW9kdWxlcywgZXhlY3V0ZU1vZHVsZXMgfHwgW10pO1xuXG4gXHRcdC8vIHJ1biBkZWZlcnJlZCBtb2R1bGVzIHdoZW4gYWxsIGNodW5rcyByZWFkeVxuIFx0XHRyZXR1cm4gY2hlY2tEZWZlcnJlZE1vZHVsZXMoKTtcbiBcdH07XG4gXHRmdW5jdGlvbiBjaGVja0RlZmVycmVkTW9kdWxlcygpIHtcbiBcdFx0dmFyIHJlc3VsdDtcbiBcdFx0Zm9yKHZhciBpID0gMDsgaSA8IGRlZmVycmVkTW9kdWxlcy5sZW5ndGg7IGkrKykge1xuIFx0XHRcdHZhciBkZWZlcnJlZE1vZHVsZSA9IGRlZmVycmVkTW9kdWxlc1tpXTtcbiBcdFx0XHR2YXIgZnVsZmlsbGVkID0gdHJ1ZTtcbiBcdFx0XHRmb3IodmFyIGogPSAxOyBqIDwgZGVmZXJyZWRNb2R1bGUubGVuZ3RoOyBqKyspIHtcbiBcdFx0XHRcdHZhciBkZXBJZCA9IGRlZmVycmVkTW9kdWxlW2pdO1xuIFx0XHRcdFx0aWYoaW5zdGFsbGVkQ2h1bmtzW2RlcElkXSAhPT0gMCkgZnVsZmlsbGVkID0gZmFsc2U7XG4gXHRcdFx0fVxuIFx0XHRcdGlmKGZ1bGZpbGxlZCkge1xuIFx0XHRcdFx0ZGVmZXJyZWRNb2R1bGVzLnNwbGljZShpLS0sIDEpO1xuIFx0XHRcdFx0cmVzdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSBkZWZlcnJlZE1vZHVsZVswXSk7XG4gXHRcdFx0fVxuIFx0XHR9XG5cbiBcdFx0cmV0dXJuIHJlc3VsdDtcbiBcdH1cblxuIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gb2JqZWN0IHRvIHN0b3JlIGxvYWRlZCBhbmQgbG9hZGluZyBjaHVua3NcbiBcdC8vIHVuZGVmaW5lZCA9IGNodW5rIG5vdCBsb2FkZWQsIG51bGwgPSBjaHVuayBwcmVsb2FkZWQvcHJlZmV0Y2hlZFxuIFx0Ly8gUHJvbWlzZSA9IGNodW5rIGxvYWRpbmcsIDAgPSBjaHVuayBsb2FkZWRcbiBcdHZhciBpbnN0YWxsZWRDaHVua3MgPSB7XG4gXHRcdFwibWFpblwiOiAwXG4gXHR9O1xuXG4gXHR2YXIgZGVmZXJyZWRNb2R1bGVzID0gW107XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cbiBcdHZhciBqc29ucEFycmF5ID0gd2luZG93W1wid2VicGFja0pzb25wXCJdID0gd2luZG93W1wid2VicGFja0pzb25wXCJdIHx8IFtdO1xuIFx0dmFyIG9sZEpzb25wRnVuY3Rpb24gPSBqc29ucEFycmF5LnB1c2guYmluZChqc29ucEFycmF5KTtcbiBcdGpzb25wQXJyYXkucHVzaCA9IHdlYnBhY2tKc29ucENhbGxiYWNrO1xuIFx0anNvbnBBcnJheSA9IGpzb25wQXJyYXkuc2xpY2UoKTtcbiBcdGZvcih2YXIgaSA9IDA7IGkgPCBqc29ucEFycmF5Lmxlbmd0aDsgaSsrKSB3ZWJwYWNrSnNvbnBDYWxsYmFjayhqc29ucEFycmF5W2ldKTtcbiBcdHZhciBwYXJlbnRKc29ucEZ1bmN0aW9uID0gb2xkSnNvbnBGdW5jdGlvbjtcblxuXG4gXHQvLyBhZGQgZW50cnkgbW9kdWxlIHRvIGRlZmVycmVkIGxpc3RcbiBcdGRlZmVycmVkTW9kdWxlcy5wdXNoKFtcIi4vc3JjL2FwcC5qc1wiLFwidmVuZG9yc35tYWluXCJdKTtcbiBcdC8vIHJ1biBkZWZlcnJlZCBtb2R1bGVzIHdoZW4gcmVhZHlcbiBcdHJldHVybiBjaGVja0RlZmVycmVkTW9kdWxlcygpO1xuIiwiaW1wb3J0IHdwQVBJIGZyb20gJy4vd29yZHByZXNzLmpzJztcblxuY29uc3QgcGF0aG5hbWUgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWU7XG5jb25zdCBzZWFyY2ggPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoO1xuXG5jb25zdCBsb2FkRGVlcExpbmsgPSBhc3luYyBzbHVnID0+IHtcblxuXHRsZXQgdGhlbWUgPSB3cEFQSS5nZXRUaGVtZUJ5U2x1ZyhzbHVnKTtcblxuXHRpZiAodGhlbWUpIHtcblx0XHRhd2FpdCB3cEFQSS5zaG93UGFnZSh0aGVtZSk7XG5cdH0gZWxzZSB7XG5cdFx0Y29uc3QgcG9zdCA9IGF3YWl0IHdwQVBJLnNob3dQb3N0KHtzbHVnfSk7XG5cblx0XHQvL2lmIG5vIHBhZ2UgZm91bmQ6IDQwNFxuXHRcdGlmICghcG9zdCkgbm90Rm91bmQ0MDQoKTtcblx0fVxuXG59O1xuXG5jb25zdCBub3RGb3VuZDQwNCA9IGFzeW5jICgpID0+IHtcblx0d3BBUEkuY2hhbmdlQnJvd3Nlckhpc3Rvcnkoe3NsdWc6ICcvZ2hvc3Qtcml2ZXIvJ30pO1xuXHR3cEFQSS5pbml0SG9tZSh7bm90Rm91bmQ6IHRydWV9KTtcbn07XG5cbmNvbnN0IGdvSG9tZSA9IGFzeW5jICgpID0+IHtcblx0d3BBUEkuY2hhbmdlQnJvd3Nlckhpc3Rvcnkoe3NsdWc6ICcvZ2hvc3Qtcml2ZXIvJ30pO1xuXHR3cEFQSS5pbml0SG9tZSh7fSk7XG59O1xuIFxuKCBhc3luYyAoKSA9PiB7XG5cdGlmIChwYXRobmFtZSA9PSAnL2dob3N0LXJpdmVyLycpIHtcblxuXHRcdGlmICghc2VhcmNoKSB7XG5cdFx0XHRnb0hvbWUoKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc3QgdXJsID0gbmV3IFVSTCh3aW5kb3cubG9jYXRpb24uaHJlZik7XG5cdFx0XHRjb25zdCBzbHVnID0gdXJsLnNlYXJjaFBhcmFtcy5nZXQoJ25vZGUnKTtcblxuXHRcdFx0d3BBUEkuY2hhbmdlQnJvd3Nlckhpc3Rvcnkoe3NsdWd9KTtcblx0XHRcdGxvYWREZWVwTGluayhzbHVnKTtcblx0XHR9XG5cblx0fSBlbHNlIHsgXG5cdFx0XG5cdFx0Y29uc3QgZGVlcExpbmsgPSBwYXRobmFtZS5zcGxpdCgnLycpWzJdO1xuXHRcdGxvY2F0aW9uID0gYGh0dHA6Ly9sb2NhbGhvc3Q6ODg4OC9naG9zdC1yaXZlcj9ub2RlPSR7ZGVlcExpbmt9YDtcblx0fVxufSkoKTsiLCIvLyBpbXBvcnQgKiBhcyBkMyBmcm9tICdkMyc7XG5pbXBvcnQge3NlbGVjdCxnZW9UcmFuc2Zvcm0sZ2VvUGF0aCxlYXNlTGluZWFyfSBmcm9tICdkMy9kaXN0L2QzLm1pbic7XG5pbXBvcnQgbWFwQVBJIGZyb20gJy4vbWFwQVBJLmpzJztcbmltcG9ydCB3cEFQSSBmcm9tICcuL3dvcmRwcmVzcy5qcyc7XG5cbmltcG9ydCBub2Rlc0RhdGFzZXQgZnJvbSAnLi9kYXRhL2ZlYXR1cmVzLmpzb24nO1xuaW1wb3J0IHJpdmVyMTgzNCBmcm9tICcuL2RhdGEvMTgzNF9BX0pvYmluX2ZpbmFsLTIuanNvbic7XG5cbmltcG9ydCBjb25maWcgZnJvbSAnLi9jb25maWcvY29uZmlnLmpzb24nO1xuXG5jb25zdCBpbnRlcm5hbE9wdGlvbiA9IHtcblx0cGFzc1Rocm91Z2g6IHRydWUsXG59O1xuXG5sZXQgRDNnZW9QYXRoO1xubGV0IHN2ZztcbmxldCByaXZlckxpbmVzO1xubGV0IGRhdGFzZXQgPSBbXTtcbmxldCBub2Rlc1BvaW50O1xubGV0IG5vZGVzTGluZTtcbmxldCBub2Rlc1BveWdvbjtcblxuLy8gY29uc3QgZGF0YVVSTCA9ICdodHRwczovL2FwaS5tYXBib3guY29tL2RhdGFzZXRzL3YxL3NhaW50cGllcnJlbWFwcGluZy9janhkcGtnZ3MwMWdpMm9zMHNyeGR4ODM3P2FjY2Vzc190b2tlbj1way5leUoxSWpvaWMyRnBiblJ3YVdWeWNtVnRZWEJ3YVc1bklpd2lZU0k2SW1OcWREQnBPWG80YURCa1ltazBObTV3TVRVME16aHhjV2NpZlEudEgxVFpYRU1oNEtPbmFoUktSbF9CQSc7XG4vLyBjb25zdCBkYXRhVVJMID0gYGh0dHBzOi8vYXBpLm1hcGJveC5jb20vZGF0YXNldHMvdjEvJHtjb25maWcubWFwYm94LnVzZXJ9L2NqeGRwa2dnczAxZ2kyb3Mwc3J4ZHg4MzcvZmVhdHVyZXM/YWNjZXNzX3Rva2VuPXBrLmV5SjFJam9pYzJGcGJuUndhV1Z5Y21WdFlYQndhVzVuSWl3aVlTSTZJbU5xZERCcE9YbzRhREJrWW1rME5tNXdNVFUwTXpoeGNXY2lmUS50SDFUWlhFTWg0S09uYWhSS1JsX0JBYFxuXG4vLyBjb25zdCBsb2FkRGF0YSA9IGFzeW5jICgpID0+IHtcbi8vIFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChkYXRhVVJMKTtcbi8vIFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbi8vIFx0Y29uc29sZS5sb2coZGF0YSk7XG4vLyB9O1xuLy8gbG9hZERhdGEoKTtcblxuY29uc3QgaW5pdCA9IGNhbnZhcyA9PiB7XG5cblx0Y29uc3QgRDNnZW9UcmFuc2Zvcm0gPSBnZW9UcmFuc2Zvcm0oe3BvaW50Om1hcEFQSS5wcm9qZWN0UG9pbnR9KTtcblx0RDNnZW9QYXRoID0gZ2VvUGF0aCgpLnByb2plY3Rpb24oRDNnZW9UcmFuc2Zvcm0pO1xuXG5cdGRhdGFzZXQgPSBub2Rlc0RhdGFzZXQuZmVhdHVyZXM7XG5cblx0Ly8gT3ZlcmxheSBkMyBvbiB0aGUgbWFwYm94IGNhbnZhc1xuXHRzdmcgPSBzZWxlY3QoY2FudmFzKS5hcHBlbmQoJ3N2ZycpO1xuXHRzdmcuYXR0cignaWQnLCAnbWFwLWJveC12aXMnKTtcblxuXHRzdmcuYXR0cignaGVpZ2h0JywgJzEwMCUnKTtcblxuXHRkcmF3Uml2ZXIocml2ZXIxODM0LmZlYXR1cmVzLCA1MDAsIDIpO1xuXG59O1xuXG5jb25zdCBnZXRUaGVtZU5vZGVzID0gdGhlbWUgPT4ge1xuXHRjb25zdCBzZWxlY3RlZE5vZGVzID0gW107XG5cdGZvciAoY29uc3Qgbm9kZSBvZiBkYXRhc2V0KSB7XG5cdFx0Y29uc3Qgbm9kZXRoZW1lcyA9IG5vZGUucHJvcGVydGllcy50aGVtZS5zcGxpdCgnLCAnKTtcblx0XHRjb25zdCB0aGVtZU5vZGUgPSBub2RldGhlbWVzLmZpbHRlcih0ID0+IHQudG9Mb3dlckNhc2UoKSA9PT0gdGhlbWUpO1xuXHRcdGlmICh0aGVtZU5vZGUubGVuZ3RoID4gMCkgc2VsZWN0ZWROb2Rlcy5wdXNoKG5vZGUpO1xuXHR9XG5cdHJldHVybiBzZWxlY3RlZE5vZGVzO1xufTtcblxuY29uc3QgZHJhd05vZGVzID0gKHtzbHVnOiB0aGVtZX0pID0+IHtcblxuXHRjb25zdCB0aGVtZU5vZGVzID0gZ2V0VGhlbWVOb2Rlcyh0aGVtZSk7XG5cdGNvbnN0IHBvaW50cyA9IHRoZW1lTm9kZXMuZmlsdGVyKG4gPT4gbi5nZW9tZXRyeS50eXBlID09PSAnUG9pbnQnKTtcblx0Y29uc3QgbGluZXMgPSB0aGVtZU5vZGVzLmZpbHRlcihuID0+IG4uZ2VvbWV0cnkudHlwZSA9PT0gJ0xpbmVTdHJpbmcnKTtcblx0Y29uc3QgcG9seWdvbnMgPSB0aGVtZU5vZGVzLmZpbHRlcihuID0+IG4uZ2VvbWV0cnkudHlwZSA9PT0gJ1BvbHlnb24nKTtcblx0Ly8gY29uc29sZS5sb2codGhlbWVOb2Rlcyxwb2ludHMsbGluZXMscG9seWdvbnMpO1xuXG5cdGRyYXdQb2ludHMoe2RhdGE6cG9pbnRzfSk7XG5cdGRyYXdMaW5lcyh7ZGF0YTpsaW5lc30pO1xuXHRkcmF3UG9seWdpbnMoe2RhdGE6cG9seWdvbnN9KTtcblxufTtcblxuY29uc3QgZHJhd1BvaW50cyA9ICAoe2RhdGEsIHRyYW5zaXRpb25UaW1lID0gNTAwMCwgZGVsYXlUaW1lID0gMTAwMH0pID0+IHtcblxuXHQvLyBBZGQgY2lyY2xlc1xuXHRub2Rlc1BvaW50ID0gc3ZnLnNlbGVjdEFsbCgnLmNpcmNsZScpXG5cdFx0LmRhdGEoZGF0YSk7XG5cblx0bm9kZXNQb2ludC5leGl0KClcblx0XHQuYXR0cignaWQnLCAnZXhpdCcpXG5cdFx0LmF0dHIoJ2NsYXNzJywgJ2V4aXQnKVxuXHRcdC50cmFuc2l0aW9uKClcblx0XHQuZHVyYXRpb24oNTAwKVxuXHRcdC5zdHlsZSgnZmlsbCcsICcjMDAwMDAwJylcblx0XHQuYXR0cigncicsIDApXG5cdFx0LnJlbW92ZSgpO1xuXG5cdG5vZGVzUG9pbnQuZW50ZXIoKS5hcHBlbmQoJ2NpcmNsZScpXG5cdFx0LmF0dHIoJ2NsYXNzJywgJ2NpcmNsZScpO1xuXG5cdG5vZGVzUG9pbnQgPSBzdmcuc2VsZWN0QWxsKCcuY2lyY2xlJylcblx0XHQuYXR0cignaWQnLCBmdW5jdGlvbiAoZCkge1xuXHRcdFx0cmV0dXJuIGBpbmRleC0ke2QucHJvcGVydGllcy5pZH1gO1xuXHRcdH0pXG5cdFx0Lm9uKCdjbGljaycsIGZ1bmN0aW9uIChkKSB7XG5cdFx0XHR3cEFQSS5zaG93UG9zdChkLnByb3BlcnRpZXMpO1xuXHRcdH0pXG5cdFx0Ly8gLm9uKCdtb3VzZW92ZXInLCBmdW5jdGlvbiAoZCkge1xuXHRcdC8vIFx0Ly8gX3RoaXMuX21vdXNlT3ZlclNlbGVjdGlvbihkKTtcblx0XHQvLyBcdGNvbnNvbGUubG9nKGQucHJvcGVydGllcyk7XG5cdFx0Ly8gfSlcblx0XHQvLyAub24oJ21vdXNlb3V0JywgZnVuY3Rpb24gKGQpIHtcblx0XHQvLyBcdC8vIF90aGlzLl9tb3VzZU91dFNlbGVjdGlvbihkKTtcblx0XHQvLyBcdC8vIGNvbnNvbGUubG9nKGQpO1xuXHRcdC8vIH0pXG5cdFx0LmF0dHIoJ2N4JywgZnVuY3Rpb24gKGQpIHtcblx0XHRcdHJldHVybiBtYXBBUEkucHJvamVjdChkLmdlb21ldHJ5LmNvb3JkaW5hdGVzKS54O1xuXHRcdH0pXG5cdFx0LmF0dHIoJ2N5JywgZnVuY3Rpb24gKGQpIHtcblx0XHRcdHJldHVybiBtYXBBUEkucHJvamVjdChkLmdlb21ldHJ5LmNvb3JkaW5hdGVzKS55O1xuXHRcdH0pXG5cdFx0LmF0dHIoJ3InLCAwKVxuXHRcdC5zdHlsZSgnb3BhY2l0eScsIDAuMSk7XG5cdC8vIC5zdHlsZSgnZmlsbCcsIClcblx0Ly8gLnN0eWxlKCdzdHJva2UnLCApO1xuXHRcdFxuXHRub2Rlc1BvaW50LnRyYW5zaXRpb24oKVxuXHRcdC5kdXJhdGlvbih0cmFuc2l0aW9uVGltZSlcblx0XHQuZGVsYXkoZnVuY3Rpb24gKGQsIGkpIHtcblx0XHRcdHJldHVybiBkZWxheVRpbWUgKiBpO1xuXHRcdH0pXG5cdFx0LmF0dHIoJ3InLCA4KVxuXHRcdC5zdHlsZSgnb3BhY2l0eScsIDAuOCk7XG59O1xuXG5jb25zdCBkcmF3TGluZXMgPSAgKHtkYXRhLCB0cmFuc2l0aW9uVGltZSA9IDUwMDAsIGRlbGF5VGltZSA9IDEwMDB9KSA9PiB7XG5cblx0Ly8gQWRkIGNpcmNsZXNcblx0bm9kZXNMaW5lID0gc3ZnLnNlbGVjdEFsbCgnLmxpbmUnKVxuXHRcdC5kYXRhKGRhdGEpO1xuXG5cdG5vZGVzTGluZS5leGl0KClcblx0XHQuYXR0cignaWQnLCAnZXhpdCcpXG5cdFx0LmF0dHIoJ2NsYXNzJywgJ2V4aXQnKVxuXHRcdC50cmFuc2l0aW9uKClcblx0XHQuZHVyYXRpb24oNTAwKVxuXHRcdC5zdHlsZSgnZmlsbCcsICcjMDAwMDAwJylcblx0XHQuYXR0cignd2lkdGgnLCAwKVxuXHRcdC5yZW1vdmUoKTtcblxuXHRub2Rlc0xpbmUuZW50ZXIoKS5hcHBlbmQoJ3BhdGgnKVxuXHRcdC5hdHRyKCdjbGFzcycsICdsaW5lJyk7XG5cblx0bm9kZXNMaW5lID0gc3ZnLnNlbGVjdEFsbCgnLmxpbmUnKVxuXHRcdC5hdHRyKCdpZCcsIGZ1bmN0aW9uIChkKSB7XG5cdFx0XHRyZXR1cm4gZC5wcm9wZXJ0aWVzLmlkO1xuXHRcdH0pXG5cdFx0LmF0dHIoJ2QnLCBEM2dlb1BhdGgpXG5cdFx0Ly8gLm9uKCdtb3VzZW92ZXInLCBmdW5jdGlvbiAoZCkge1xuXHRcdC8vIFx0Ly8gY29uc29sZS5sb2coZCk7XG5cdFx0Ly8gfSlcblx0XHQvLyAub24oJ21vdXNlb3V0JywgZnVuY3Rpb24gKGQpIHtcblx0XHQvLyBcdC8vIGNvbnNvbGUubG9nKGQpO1xuXHRcdC8vIH0pXG5cdFx0Lm9uKCdjbGljaycsIGZ1bmN0aW9uIChkKSB7XG5cdFx0XHR3cEFQSS5zaG93UG9zdChkLnByb3BlcnRpZXMpO1xuXHRcdH0pXG5cdFx0LnN0eWxlKCdjdXJzb3InLCAncG9pbnRlcicpXG5cdFx0LnN0eWxlKCdmaWxsJywnbm9uZScpXG5cdFx0LnN0eWxlKCdzdHJva2Utd2lkdGgnLCAwKVxuXHRcdC5zdHlsZSgnc3Ryb2tlJywgJyNGRjhDMDAnKVxuXHRcdC5zdHlsZSgnb3BhY2l0eScsIDAuMSk7XG5cblxuXHRub2Rlc0xpbmUudHJhbnNpdGlvbigpXG5cdFx0LmR1cmF0aW9uKHRyYW5zaXRpb25UaW1lKVxuXHRcdC5kZWxheShmdW5jdGlvbiAoZCwgaSkge1xuXHRcdFx0cmV0dXJuIGRlbGF5VGltZSAqIGk7XG5cdFx0fSlcblx0XHQuc3R5bGUoJ3N0cm9rZS13aWR0aCcsIDIpXG5cdFx0LnN0eWxlKCdvcGFjaXR5JywgMC44KTtcblxuXG59O1xuXG5jb25zdCBkcmF3UG9seWdpbnMgPSAgKHtkYXRhLCB0cmFuc2l0aW9uVGltZSA9IDUwMDAsIGRlbGF5VGltZSA9IDEwMDB9KSA9PiB7XG5cblx0Ly8gQWRkIGNpcmNsZXNcblx0bm9kZXNQb3lnb24gPSBzdmcuc2VsZWN0QWxsKCcucG9seWdvbnMnKVxuXHRcdC5kYXRhKGRhdGEpO1xuXG5cdG5vZGVzUG95Z29uLmV4aXQoKVxuXHRcdC5hdHRyKCdpZCcsICdleGl0Jylcblx0XHQuYXR0cignY2xhc3MnLCAnZXhpdCcpXG5cdFx0LnRyYW5zaXRpb24oKVxuXHRcdC5kdXJhdGlvbig1MDApXG5cdFx0LnN0eWxlKCdmaWxsJywgJyMwMDAwMDAnKVxuXHRcdC5hdHRyKCd3aWR0aCcsIDApXG5cdFx0LnJlbW92ZSgpO1xuXG5cdG5vZGVzUG95Z29uLmVudGVyKCkuYXBwZW5kKCdwYXRoJylcblx0XHQuYXR0cignY2xhc3MnLCAncG9seWdvbnMnKTtcblxuXHRub2Rlc1BveWdvbiA9IHN2Zy5zZWxlY3RBbGwoJy5wb2x5Z29ucycpXG5cdFx0LmF0dHIoJ2lkJywgZnVuY3Rpb24gKGQpIHtcblx0XHRcdHJldHVybiBkLnByb3BlcnRpZXMuaWQ7XG5cdFx0fSlcblx0XHQuYXR0cignZCcsIEQzZ2VvUGF0aClcblx0XHQvLyAub24oJ21vdXNlb3ZlcicsIGZ1bmN0aW9uIChkKSB7XG5cdFx0Ly8gXHQvLyBjb25zb2xlLmxvZyhkKTtcblx0XHQvLyB9KVxuXHRcdC8vIC5vbignbW91c2VvdXQnLCBmdW5jdGlvbiAoZCkge1xuXHRcdC8vIFx0Ly8gY29uc29sZS5sb2coZCk7XG5cdFx0Ly8gfSlcblx0XHQub24oJ2NsaWNrJywgZnVuY3Rpb24gKGQpIHtcblx0XHRcdHdwQVBJLnNob3dQb3N0KGQucHJvcGVydGllcyk7XG5cdFx0fSlcblx0XHQuc3R5bGUoJ2N1cnNvcicsICdwb2ludGVyJylcblx0XHQuc3R5bGUoJ2ZpbGwnLCcjRkZBNTAwJylcblx0XHQuc3R5bGUoJ3N0cm9rZS13aWR0aCcsIDApXG5cdFx0LnN0eWxlKCdzdHJva2UnLCAnI0ZGOEMwMCcpXG5cdFx0LnN0eWxlKCdvcGFjaXR5JywgMC4xKTtcblxuXG5cdG5vZGVzUG95Z29uLnRyYW5zaXRpb24oKVxuXHRcdC5kdXJhdGlvbih0cmFuc2l0aW9uVGltZSlcblx0XHQuZGVsYXkoZnVuY3Rpb24gKGQsIGkpIHtcblx0XHRcdHJldHVybiBkZWxheVRpbWUgKiBpO1xuXHRcdH0pXG5cdFx0LnN0eWxlKCdzdHJva2Utd2lkdGgnLCAyKVxuXHRcdC5zdHlsZSgnb3BhY2l0eScsIDAuOCk7XG5cbn07XG5cbmNvbnN0IGRyYXdSaXZlciA9IGRhdGEgPT4ge1xuXG5cdHJpdmVyTGluZXMgPSBzdmcuc2VsZWN0QWxsKCcjcml2ZXInKVxuXHRcdC5kYXRhKGRhdGEpXG5cdFx0LmVudGVyKClcblx0XHQuYXBwZW5kKCdwYXRoJylcblx0XHQuYXR0cignaWQnLCAncml2ZXInKVxuXHRcdC5hdHRyKCdkJywgRDNnZW9QYXRoKVxuXHRcdC5zdHlsZSgnZmlsbCcsJ25vbmUnKVxuXHRcdC5zdHlsZSgnc3Ryb2tlLXdpZHRoJywgMSlcblx0XHQuc3R5bGUoJ3N0cm9rZScsICcjMDA3MWJjJylcblx0XHQuc3R5bGUoJ29wYWNpdHknLCAwLjgpO1xuXG5cdC8vIHJpdmVyTGluZXMudHJhbnNpdGlvbigpXG5cdC8vIFx0LmR1cmF0aW9uKDEwMDApXG5cdC8vIFx0LnN0eWxlKCdzdHJva2Utd2lkdGgnLCA0KVxuXHQvLyBcdC5zdHlsZSgnb3BhY2l0eScsIDAuOCk7XG5cblx0Ly9ncmFwaCBhbmltYXRpb25cblx0bGV0IGxpbmVMZW5ndGggPSByaXZlckxpbmVzLm5vZGUoKS5nZXRUb3RhbExlbmd0aCgpO1xuXG5cdHJpdmVyTGluZXNcblx0XHQuYXR0cignc3Ryb2tlLWRhc2hhcnJheScsIGxpbmVMZW5ndGggKyAnICcgKyBsaW5lTGVuZ3RoKVxuXHRcdC5hdHRyKCdzdHJva2UtZGFzaG9mZnNldCcsICtsaW5lTGVuZ3RoKVxuXHRcdC50cmFuc2l0aW9uKClcblx0XHQuZHVyYXRpb24oODAwMClcblx0XHQuZWFzZShlYXNlTGluZWFyKVxuXHRcdC5hdHRyKCdzdHJva2UtZGFzaG9mZnNldCcsIDApXG5cdFx0LnN0eWxlKCdzdHJva2Utd2lkdGgnLCAzKVxuXHRcdC5vbignZW5kJywgKCkgPT4ge1xuXHRcdFx0aWYoIWludGVybmFsT3B0aW9uLnBhc3NUaHJvdWdoKSBtYXBBUEkucGl0Y2hNYXAoe2ZpbmFsUGl0Y2g6NDAsIGR1cmF0aW9uOjIwMDB9KTtcblx0XHR9KTtcbn07XG5cbmNvbnN0IG1hcFVwZGF0ZSA9ICAoKSA9PiB7XG5cdHJpdmVyVXBkYXRlKCk7XG5cdG5vZGVVcGRhdGUoKTtcbn07XG5cbmNvbnN0IHJpdmVyVXBkYXRlID0gKCkgPT4ge1xuXHRpZiAocml2ZXJMaW5lcykge1xuXHRcdHJpdmVyTGluZXNcblx0XHRcdC5hdHRyKCdkJywgRDNnZW9QYXRoKVxuXHRcdFx0LmF0dHIoJ3N0cm9rZS1kYXNoYXJyYXknLCAnbm9uZScpXG5cdFx0XHQuYXR0cignc3Ryb2tlLWRhc2hvZmZzZXQnLCAnbm9uZScpO1xuXHR9XG59O1xuXG5jb25zdCBub2RlVXBkYXRlID0gKCkgPT4ge1xuXHRcblx0aWYgKG5vZGVzUG9pbnQpIHtcblx0XHRub2Rlc1BvaW50XG5cdFx0XHQuYXR0cignY3gnLCBmdW5jdGlvbiAoZCkge1xuXHRcdFx0XHRyZXR1cm4gbWFwQVBJLnByb2plY3QoZC5nZW9tZXRyeS5jb29yZGluYXRlcykueDtcblx0XHRcdH0pXG5cdFx0XHQuYXR0cignY3knLCBmdW5jdGlvbiAoZCkge1xuXHRcdFx0XHRyZXR1cm4gbWFwQVBJLnByb2plY3QoZC5nZW9tZXRyeS5jb29yZGluYXRlcykueTtcblx0XHRcdH0pO1xuXHR9XG5cblx0aWYgKG5vZGVzTGluZSkgbm9kZXNMaW5lLmF0dHIoJ2QnLCBEM2dlb1BhdGgpO1xuXHRpZiAobm9kZXNQb3lnb24pIG5vZGVzUG95Z29uLmF0dHIoJ2QnLCBEM2dlb1BhdGgpO1xuXHRcbn07XG5cblxuXG5leHBvcnQgZGVmYXVsdCB7XG5cdGluaXQsXG5cdGRyYXdOb2Rlcyxcblx0bWFwVXBkYXRlXG59OyIsImltcG9ydCB7c2VsZWN0LG1vdXNlLHNjYWxlTGluZWFyfSBmcm9tICdkMy9kaXN0L2QzLm1pbic7XG5pbXBvcnQgbWFwYm94Z2wgZnJvbSAnbWFwYm94LWdsJztcbi8vIGltcG9ydCAnbWFwYm94LWdsL2Rpc3QvbWFwYm94LWdsLmNzcydcbmltcG9ydCBjb25maWcgZnJvbSAnLi9jb25maWcvY29uZmlnLmpzb24nO1xuaW1wb3J0IGRhdGF2aXMgZnJvbSAnLi9kYXRhdmlzLmpzJztcblxuY29uc3QgaW50ZXJuYWxPcHRpb24gPSB7XG5cdG1vdXNlUGl0Y2g6IGZhbHNlXG59O1xuXG5tYXBib3hnbC5hY2Nlc3NUb2tlbiA9IGNvbmZpZy5tYXBib3gudG9rZW47XG5sZXQgbWFwYm94O1xuY29uc3QgYm91bmRzID0gW1xuXHRbLTczLjgxLDQ1LjM1XSxcblx0Wy03My4zNCw0NS41OF1cbl07XG5cbmxldCBwaXRjaEFuaW1hdGlvbjtcblxuY29uc3QgbWFwQm94Q29uZmlnID0ge1xuXHRjb250YWluZXI6ICdtYXAnLFxuXHRzdHlsZTogYG1hcGJveDovL3N0eWxlcy8ke2NvbmZpZy5tYXBib3gudXNlcn0vY2p4emJzN25mMGE0YjFjb3dwODB0c25keWAsXG5cdGNlbnRlcjogWy03My41NiwgNDUuNDY1XSwgLy9jZW50ZXIgaW4gTW9udHJlYWxcblx0em9vbTogMTEuNSxcblx0cGl0Y2g6IDAsXG5cdGludGVyYWN0aXZlOiB0cnVlLFxuXHQvLyBtYXhab29tOiAxNyxcblx0bWF4Qm91bmRzOiBudWxsLy9ib3VuZHMgLy8gU2V0cyBib3VuZHMgYXMgbWF4XG59O1xuXG5jb25zdCBpbml0ID0gYXN5bmMgKHttYXBJRCwgbm90Rm91bmR9KSA9PiB7XG5cblx0cmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuXG5cdFx0aWYgKG1hcElEKSBtYXBCb3hDb25maWcuc3R5bGUgPSBgbWFwYm94Oi8vc3R5bGVzLyR7Y29uZmlnLm1hcGJveC51c2VyfS8ke21hcElEfWA7XG5cdFx0aWYgKG5vdEZvdW5kKSB7XG5cblx0XHRcdGNvbnN0IGxhdCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDE4MCkgLSA5MDtcblx0XHRcdGNvbnN0IGxvbiA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDM2MCkgLSAxODA7XG5cblx0XHRcdG1hcEJveENvbmZpZy56b29tID0gNTtcblx0XHRcdG1hcEJveENvbmZpZy5jZW50ZXIgPSBbbG9uLGxhdF07XG5cdFx0XHQvLyBkZWxldGUgbWFwQm94Q29uZmlnLm1heEJvdW5kcztcblx0XHR9XG5cblx0XHRjb25zb2xlLmxvZyhtYXBCb3hDb25maWcpO1xuXHRcdGNvbnN0IG1hcENvbnRhaW5lciA9IHNlbGVjdCgnI2FwcCcpLnNlbGVjdCgnOmZpcnN0LWNoaWxkJykuYXBwZW5kKCdkaXYnKTsgLy9tYXAgY29udGFpbmVyIHNldCBvbiBXUCA+IEJlYXZlclxuXHRcdG1hcENvbnRhaW5lci5hdHRyKCdpZCcsICdtYXAnKTtcblxuXHRcdG1hcGJveCA9IG5ldyBtYXBib3hnbC5NYXAobWFwQm94Q29uZmlnKTtcblx0XHQvLyBjb25zdCBjYW52YXMgPSBtYXBib3guZ2V0Q2FudmFzQ29udGFpbmVyKCk7XG5cdFx0XG5cdFx0bWFwYm94Lm9uKCd2aWV3cmVzZXQnLCB1cGRhdGUpO1xuXHRcdG1hcGJveC5vbignbW92ZScsIHVwZGF0ZSk7XG5cdFx0bWFwYm94Lm9uKCdtb3ZlZW5kJywgdXBkYXRlKTtcblxuXG5cdFx0bWFwYm94Lm9uKCdsb2FkJywgKCkgPT4ge1xuXHRcdFx0Ly8gcGl0Y2hNYXAoKTtcblxuXHRcdFx0ZGF0YXZpcy5pbml0KG1hcGJveC5nZXRDYW52YXNDb250YWluZXIoKSk7XG5cdFx0XHRpZihpbnRlcm5hbE9wdGlvbi5tb3VzZVBpdGNoKSBtb3VzZU1hcFBpdGNoKCk7XG5cdFx0XHRcblx0XHRcdGlmIChub3RGb3VuZCkge1xuXHRcdFx0XHRtYXBib3guZmx5VG8oe1xuXHRcdFx0XHRcdGNlbnRlcjogWy03My41NiwgNDUuNDY1XSxcblx0XHRcdFx0XHR6b29tOiAxMS41LFxuXHRcdFx0XHRcdHNwZWVkOiAxLFxuXHRcdFx0XHRcdGN1cnZlOiAxLFxuXHRcdFx0XHRcdG1pblpvb206IDMsXG5cdFx0XHRcdFx0Ly8gcGl0Y2g6IDYwLFxuXHRcdFx0XHRcdG1hY0JvdW5kczogYm91bmRzLFxuXHRcdFx0XHRcdC8vIG1heER1cmF0aW9uOiA1MDAwLFxuXHRcdFx0XHRcdGVhc2luZzogZnVuY3Rpb24gKHQpIHsgcmV0dXJuIHQ7IH1cblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0bWFwYm94Lm9uKCdtb3ZlZW5kJywgKCkgPT4ge1xuXHRcdFx0XHRcdGlmIChtYXBib3guZ2V0TWF4Qm91bmRzKCkgPT0gbnVsbCkgbWFwYm94LnNldE1heEJvdW5kcyhib3VuZHMpO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0Ly8gbWFwYm94LnNldE1heEJvdW5kcyA9IGJvdW5kcztcblx0XHRcdH1cblx0XHRcdFxuXG5cdFx0XHRyZXNvbHZlKCk7XG5cdFx0fSk7XG5cdH0pO1xuXG59O1xuXG5cbmNvbnN0IGlzTWFwYm94TG9hZGVkID0gKCkgPT4gIHtcblx0aWYgKG1hcGJveCkgcmV0dXJuIG1hcGJveC5pc1N0eWxlTG9hZGVkKCk7XG5cdHJldHVybiBmYWxzZTtcbn07XG5cbmNvbnN0IHBpdGNoTWFwID0gKHtmaW5hbFBpdGNoID0gMCwgZHVyYXRpb24gPSAxMDAwfSkgPT4ge1xuXG5cdGlmIChwaXRjaEFuaW1hdGlvbikgY2xlYXJJbnRlcnZhbChwaXRjaEFuaW1hdGlvbik7XG5cblx0Y29uc3QgdGljayA9IDEwO1xuXHRsZXQgZWxhcHNlID0gMDtcblxuXHRjb25zdCBzY2FsZVBpdGNoID0gc2NhbGVMaW5lYXIoKVxuXHRcdC5kb21haW4oWzAsIGR1cmF0aW9uXSlcblx0XHQucmFuZ2UoW21hcGJveC5nZXRQaXRjaCgpLCBmaW5hbFBpdGNoXSk7XG5cblx0Ly8gY29uc3Qgc2NhbGVab29tID0gc2NhbGVMaW5lYXIoKVxuXHQvLyBcdC5kb21haW4oWzAsIG1heF0pXG5cdC8vIFx0LnJhbmdlKFsxMS41LCAxMl0pO1xuXG5cdHBpdGNoQW5pbWF0aW9uID0gc2V0SW50ZXJ2YWwoICgpID0+IHtcblx0XHRtYXBib3guc2V0UGl0Y2goc2NhbGVQaXRjaChlbGFwc2UpKTtcblx0XHQvLyBtYXBib3guc2V0Wm9vbShzY2FsZVpvb20oZWxhcHNlKSk7XG5cdFx0ZWxhcHNlICs9IHRpY2s7XG5cdFx0aWYgKGVsYXBzZSA+IGR1cmF0aW9uKSB7XG5cdFx0XHRjbGVhckludGVydmFsKHBpdGNoQW5pbWF0aW9uKTtcblx0XHRcdHBpdGNoQW5pbWF0aW9uID0gbnVsbDtcblx0XHR9XG5cdH0sIHRpY2spO1xuXG59O1xuXG5jb25zdCBtb3VzZU1hcFBpdGNoID0gKCkgPT4ge1xuXHRjb25zdCBfc2NhbGUgPSBzY2FsZUxpbmVhcigpXG5cdFx0LmRvbWFpbihbMCwgd2luZG93LmlubmVyV2lkdGhdKVxuXHRcdC5yYW5nZShbMCwgNjBdKTtcblxuXHRzZWxlY3QoJyNtYXAnKS5vbignbW91c2Vtb3ZlJywgZnVuY3Rpb24oKSB7XG5cdFx0Y29uc3QgX21vdXNlID0gbW91c2UodGhpcyk7XG5cdFx0Y29uc29sZS5sb2coX21vdXNlWzBdLCBfc2NhbGUoX21vdXNlWzBdKSk7XG5cdFx0bWFwYm94LnNldFBpdGNoKF9zY2FsZShfbW91c2VbMF0pKTtcblx0fSk7XG59O1xuXG5jb25zdCB1cGRhdGUgPSAoKSA9PiBkYXRhdmlzLm1hcFVwZGF0ZSgpO1xuXG4vLyBQcm9qZWN0IEdlb0pTT04gY29vcmRpbmF0ZSB0byB0aGUgbWFwJ3MgY3VycmVudCBzdGF0ZVxuY29uc3QgcHJvamVjdCA9IGQgPT4gbWFwYm94LnByb2plY3QobmV3IG1hcGJveGdsLkxuZ0xhdCgrZFswXSwgK2RbMV0pKTtcblxuLy8gUHJvamVjdCBHZW9KU09OIGNvb3JkaW5hdGUgdG8gdGhlIG1hcCdzIGN1cnJlbnQgc3RhdGVcbmNvbnN0IHByb2plY3RQb2ludCA9IGZ1bmN0aW9uIChsb24sIGxhdCkge1xuXHRsZXQgcG9pbnQgPSBtYXBib3gucHJvamVjdChuZXcgbWFwYm94Z2wuTG5nTGF0KGxvbiwgbGF0KSk7XG5cdHRoaXMuc3RyZWFtLnBvaW50KHBvaW50LngsIHBvaW50LnkpO1xufTtcblxuY29uc3QgY2hhbmdlTWFwID0gKHttYXBJRH0pID0+IHtcblx0bWFwYm94LnNldFN0eWxlKGBtYXBib3g6Ly9zdHlsZXMvJHtjb25maWcubWFwYm94LnVzZXJ9LyR7bWFwSUR9YCk7XG5cdHBpdGNoTWFwKHtmaW5hbFBpdGNoOjAsIGR1cmF0aW9uOjF9KTtcbn07XG5cblxuZXhwb3J0IGRlZmF1bHQge1xuXHRpbml0LFxuXHR1cGRhdGUsXG5cdHByb2plY3QsXG5cdHByb2plY3RQb2ludCxcblx0Y2hhbmdlTWFwLFxuXHRwaXRjaE1hcCxcblx0aXNNYXBib3hMb2FkZWRcbn07XG4iLCJpbXBvcnQgV1BBUEkgZnJvbSAnd3BhcGknO1xuaW1wb3J0IHtzZWxlY3QsIHNlbGVjdEFsbCwgZXZlbnR9IGZyb20gJ2QzL2Rpc3QvZDMubWluJztcbmltcG9ydCBtYXBBUEkgZnJvbSAnLi9tYXBBUEkuanMnO1xuaW1wb3J0IGRhdGF2aXMgZnJvbSAnLi9kYXRhdmlzLmpzJztcbmltcG9ydCBjb25maWcgZnJvbSAnLi9jb25maWcvY29uZmlnLmpzb24nO1xuXG5jb25zdCB3cCA9IG5ldyBXUEFQSSh7XG5cdGVuZHBvaW50OiBjb25maWcud29yZHByZXNzLnJlbW90ZS5lbmRwb2ludFxufSk7XG5cbmNvbnN0IGludGVybmFsT3B0aW9uID0ge1xuXHRhbmltYXRpb246IHtcblx0XHRkdXJhdGlvbjoge1xuXHRcdFx0aW46IDMwMDAsXG5cdFx0XHRvdXQ6IDIwMDBcblx0XHR9XG5cdH0sXG5cdG1haW5NZW51OiBmYWxzZSxcblx0dG9wTWVudTogZmFsc2UsXG59O1xuXG5jb25zdCB0aGVtZXMgPSBbXG5cdHtcblx0XHRpZDogMCxcblx0XHRzbHVnOiAnaG9tZScsXG5cdFx0bWFwSUQ6ICdjanh6YnM3bmYwYTRiMWNvd3A4MHRzbmR5Jyxcblx0XHRzdGF0ZTogJ2hvbWUnXG5cdH0sXG5cdHtcblx0XHRpZDogNTYsXG5cdFx0c2x1ZzogJ2Fib3V0Jyxcblx0XHRtYXBJRDogJ2NqeWJzOXR1djFnbmwxY2xwbG4wczV2cTknLFxuXHRcdHN0YXRlOiAncGFnZSdcblx0fSxcblx0e1xuXHRcdGlkOiAxMTQsXG5cdFx0c2x1ZzogJ2Vudmlyb25tZW50Jyxcblx0XHRtYXBJRDogJ2NqdGYzcXBzbzAza2gxZmt2em84ZGQ0eGsnLFxuXHRcdHN0YXRlOiAncGFnZSdcblx0fSxcblx0e1xuXHRcdGlkOiAxMTgsXG5cdFx0c2x1ZzogJ3N0ZXBzJyxcblx0XHRtYXBJRDogJ2NqdGcwYzQydjB3NXgxZnFsZjFybWZzNzYnLFxuXHRcdHN0YXRlOiAncGFnZSdcblx0fSxcblx0e1xuXHRcdGlkOiAxMTYsXG5cdFx0c2x1ZzogJ3dhdGVyJyxcblx0XHRtYXBJRDogJ2NqdWVlNTFiOTJpbXIxZnBvZjh1MTE5d3MnLFxuXHRcdHN0YXRlOiAncGFnZSdcblx0fVxuXTtcblxubGV0IHRoZW1lID0gdGhlbWVzWzBdO1xuXG5jb25zdCBnZXRUaGVtZUJ5U2x1ZyA9IHNsdWcgPT4gdGhlbWVzLmZpbmQoIHRoZW1lID0+IHRoZW1lLnNsdWcgPT09IHNsdWcgKTtcblxuY29uc3QgaW5pdEhvbWUgPSAoe25vdEZvdW5kfSkgPT4ge1xuXG5cdHNlbGVjdCgnI2hvbWUtdGV4dCcpXG5cdFx0LnN0eWxlKCdvcGFjaXR5JywgMClcblx0XHQuc3R5bGUoJ2Rpc3BsYXknLCAnYmxvY2snKVxuXHRcdC50cmFuc2l0aW9uKClcblx0XHQuZGVsYXkoMCkgLy8zMDAwXG5cdFx0LmR1cmF0aW9uKDApXG5cdFx0Ly8gLmR1cmF0aW9uKGludGVybmFsT3B0aW9uLmFuaW1hdGlvbi5kdXJhdGlvbi5pbilcblx0XHQuc3R5bGUoJ29wYWNpdHknLCAxKTtcblxuXHRsZXQgZGVsYXkgPSAwOyAvLzgwMDBcblx0XG5cdGZvciAoY29uc3QgdGhlbWUgb2YgdGhlbWVzKSB7XG5cblx0XHRzZWxlY3QoYCNtYWluLSR7dGhlbWUuc2x1Z30tYnRgKVxuXHRcdFx0LnN0eWxlKCdvcGFjaXR5JywgMClcblx0XHRcdC5zdHlsZSgnZGlzcGxheScsICdibG9jaycpXG5cdFx0XHQudHJhbnNpdGlvbigpXG5cdFx0XHQuZGVsYXkoZGVsYXkpXG5cdFx0XHQuZHVyYXRpb24oaW50ZXJuYWxPcHRpb24uYW5pbWF0aW9uLmR1cmF0aW9uLmluKVxuXHRcdFx0LnN0eWxlKCdvcGFjaXR5JywgMSk7XG5cblx0XHRkZWxheSArPSAxMDAwO1xuXHR9XG5cblx0Y29uZmlnTWFpbk1lbnUoKTtcblx0dXBkYXRlTWFwKHtub3RGb3VuZH0pO1xufTtcblxuY29uc3QgY29uZmlnTWFpbk1lbnUgPSAoKSA9PiB7XG5cdGlmIChpbnRlcm5hbE9wdGlvbi5tYWluTWVudSA9PSBmYWxzZSkge1xuXHRcdGZvciAoY29uc3QgdGhlbWUgb2YgdGhlbWVzKSB7XG5cdFx0XHRzZWxlY3QoYCNtYWluLSR7dGhlbWUuc2x1Z30tYnRgKVxuXHRcdFx0XHQub24oJ2NsaWNrJywgKCkgPT4gc2hvd1BhZ2UodGhlbWUpKTtcblx0XHR9XG5cdFx0aW50ZXJuYWxPcHRpb24ubWFpbk1lbnUgPSB0cnVlO1xuXHR9XG59O1xuXG5jb25zdCBjb25maWdUb3BNZW51ID0gKCkgPT4ge1xuXHRpZiAoaW50ZXJuYWxPcHRpb24udG9wTWVudSA9PSBmYWxzZSkge1xuXHRcdGZvciAoY29uc3QgdGhlbWUgb2YgdGhlbWVzKSB7XG5cdFx0XHRzZWxlY3QoYCN0b3AtJHt0aGVtZS5zbHVnfS1idGApXG5cdFx0XHRcdC5vbignY2xpY2snLCAoKSA9PiBzaG93UGFnZSh0aGVtZSkpXG5cdFx0XHRcdC5zdHlsZSgnY3Vyc29yJywgJ3BvaW50ZXInKTsgXG5cdFx0fVxuXHRcdGludGVybmFsT3B0aW9uLnRvcE1lbnUgPSB0cnVlO1xuXHR9XG59O1xuXG5cbmNvbnN0IHNob3dIb21lID0gKCkgPT4ge1xuXG5cdHNlbGVjdCgnI2hlYWRlci1jb2wnKVxuXHRcdC5zdHlsZSgnZGlzcGxheScsICdibG9jaycpXG5cdFx0LnRyYW5zaXRpb24oKVxuXHRcdC5kZWxheSgxMDAwKVxuXHRcdC5kdXJhdGlvbigzMDAwKVxuXHRcdC5zdHlsZSgnb3BhY2l0eScsIDEpXG5cdFx0LnN0eWxlKCdtYXJnaW4tdG9wJywgJzBweCcpO1xuXG5cdHNlbGVjdEFsbCgnLmNvbC1tYWluLW1lbnUnKVxuXHRcdC5zdHlsZSgnb3BhY2l0eScsIDApXG5cdFx0LnN0eWxlKCdkaXNwbGF5JywgJ2Jsb2NrJylcblx0XHQudHJhbnNpdGlvbigpXG5cdFx0LmRlbGF5KDEwMDApXG5cdFx0LmR1cmF0aW9uKDMwMDApXG5cdFx0LnN0eWxlKCdvcGFjaXR5JywgMSlcblx0XHQuc3R5bGUoJ21hcmdpbi10b3AnLCAnMHB4Jyk7XG5cblx0c2VsZWN0KCcjaG9tZS10ZXh0Jylcblx0XHQuc3R5bGUoJ2Rpc3BsYXknLCAnYmxvY2snKVxuXHRcdC5zdHlsZSgnb3BhY2l0eScsIDEpO1xuXG5cdGZvciAoY29uc3QgdGhlbWUgb2YgdGhlbWVzKSB7XG5cdFx0c2VsZWN0KGAjbWFpbi0ke3RoZW1lLnNsdWd9LWJ0YClcblx0XHRcdC5zdHlsZSgnZGlzcGxheScsICdibG9jaycpXG5cdFx0XHQuc3R5bGUoJ29wYWNpdHknLCAxKTtcblx0fVxuXG5cdGNvbmZpZ01haW5NZW51KCk7XG59O1xuXG5jb25zdCBoaWRlSG9tZSA9ICgpID0+IHtcblx0c2VsZWN0KCcjaGVhZGVyLWNvbCcpXG5cdFx0LnRyYW5zaXRpb24oKVxuXHRcdC5kdXJhdGlvbigzMDAwKVxuXHRcdC5zdHlsZSgnb3BhY2l0eScsIDApXG5cdFx0LnN0eWxlKCdtYXJnaW4tdG9wJywgJy01MDBweCcpXG5cdFx0Lm9uKCdlbmQnLCBmdW5jdGlvbiAoKSB7XG5cdFx0XHRzZWxlY3QodGhpcykuc3R5bGUoJ2Rpc3BsYXknLCAnbm9uZScpO1xuXHRcdH0pO1xuXG5cdHNlbGVjdEFsbCgnLmNvbC1tYWluLW1lbnUnKVxuXHRcdC50cmFuc2l0aW9uKClcblx0XHQuZHVyYXRpb24oMzAwMClcblx0XHQuc3R5bGUoJ29wYWNpdHknLCAwKVxuXHRcdC5zdHlsZSgnbWFyZ2luLXRvcCcsICctMjAwcHgnKVxuXHRcdC5vbignZW5kJywgZnVuY3Rpb24gKCkge1xuXHRcdFx0c2VsZWN0KHRoaXMpLnN0eWxlKCdkaXNwbGF5JywgJ25vbmUnKTtcblx0XHR9KTtcbn07XG5cbmNvbnN0IHNob3dUb3BNZW51ID0gKCkgPT4ge1xuXHRzZWxlY3QoJyN0b3AtbWVudScpXG5cdFx0LnN0eWxlKCdvcGFjaXR5JywgMClcblx0XHQuc3R5bGUoJ3RvcCcsIC0yMDApXG5cdFx0LnN0eWxlKCdkaXNwbGF5JywgJ2Jsb2NrJylcblx0XHQudHJhbnNpdGlvbigpXG5cdFx0LmRlbGF5KDMwMDApXG5cdFx0LmR1cmF0aW9uKDIwMDApXG5cdFx0LnN0eWxlKCdvcGFjaXR5JywgMSlcblx0XHQuc3R5bGUoJ3RvcCcsIDApO1xuXG5cdGNvbmZpZ1RvcE1lbnUoKTtcbn07XG5cbmNvbnN0IGhpZGVUb3BNZW51ID0gKCkgPT4ge1xuXHRzZWxlY3QoJyN0b3AtbWVudScpXG5cdFx0LnRyYW5zaXRpb24oKVxuXHRcdC5kZWxheSgwKVxuXHRcdC5kdXJhdGlvbigyMDAwKVxuXHRcdC5zdHlsZSgnb3BhY2l0eScsIDApXG5cdFx0LnN0eWxlKCd0b3AnLCAtMjAwKVxuXHRcdC5vbignZW5kJywgZnVuY3Rpb24gKCkge1xuXHRcdFx0c2VsZWN0KHRoaXMpLnN0eWxlKCdkaXNwbGF5JywgJ25vbmUnKTtcblx0XHR9KTtcbn07XG5cbmNvbnN0IHNob3dQYW5lbCA9ICh7ZGlyZWN0aW9uID0gJ25vbmUnLCBkZWxheSA9IDB9KSA9PiB7XG5cblx0aWYgKGRpcmVjdGlvbiA9PSAnbm9uZScpIHtcblx0XHRkaXJlY3Rpb24gPSAnMHB4Jztcblx0fSBlbHNlIGlmIChkaXJlY3Rpb24gPT0gJ3VwJykge1xuXHRcdGRpcmVjdGlvbiA9ICctMjAwMHB4Jztcblx0fSBlbHNlIGlmIChkaXJlY3Rpb24gPT0gJ2Rvd24nKSB7XG5cdFx0ZGlyZWN0aW9uID0gJzIwMDBweCc7XG5cdH1cblxuXHRzZWxlY3QoJyNsZWZ0LXBhbmVsJylcblx0XHQuc3R5bGUoJ29wYWNpdHknLCAwKVxuXHRcdC5zdHlsZSgnbWFyZ2luLXRvcCcsIGRpcmVjdGlvbilcblx0XHQuc3R5bGUoJ2Rpc3BsYXknLCAnYmxvY2snKVxuXHRcdC50cmFuc2l0aW9uKClcblx0XHQuZGVsYXkoZGVsYXkpXG5cdFx0LmR1cmF0aW9uKGludGVybmFsT3B0aW9uLmFuaW1hdGlvbi5kdXJhdGlvbi5pbilcblx0XHQuc3R5bGUoJ29wYWNpdHknLCAwKVxuXHRcdC5zdHlsZSgnbWFyZ2luLXRvcCcsICcwcHgnKTtcblxuXHRzZWxlY3QoJyNtaWRkbGUtcGFuZWwnKVxuXHRcdC5zdHlsZSgnb3BhY2l0eScsIDApXG5cdFx0LnN0eWxlKCdtYXJnaW4tdG9wJywgZGlyZWN0aW9uKVxuXHRcdC5zdHlsZSgnZGlzcGxheScsICdibG9jaycpXG5cdFx0LnRyYW5zaXRpb24oKVxuXHRcdC5kZWxheShkZWxheSlcblx0XHQuZHVyYXRpb24oaW50ZXJuYWxPcHRpb24uYW5pbWF0aW9uLmR1cmF0aW9uLmluKVxuXHRcdC5zdHlsZSgnb3BhY2l0eScsIDApXG5cdFx0LnN0eWxlKCdtYXJnaW4tdG9wJywgJzBweCcpO1xuXG5cdHNlbGVjdCgnI3JpZ2h0LXBhbmVsJylcblx0XHQuc3R5bGUoJ29wYWNpdHknLCAwKVxuXHRcdC5zdHlsZSgnbWFyZ2luLXRvcCcsIGRpcmVjdGlvbilcblx0XHQuc3R5bGUoJ2Rpc3BsYXknLCAnYmxvY2snKVxuXHRcdC50cmFuc2l0aW9uKClcblx0XHQuZGVsYXkoZGVsYXkpXG5cdFx0LmR1cmF0aW9uKGludGVybmFsT3B0aW9uLmFuaW1hdGlvbi5kdXJhdGlvbi5pbilcblx0XHQuc3R5bGUoJ29wYWNpdHknLCAxKVxuXHRcdC5zdHlsZSgnbWFyZ2luLXRvcCcsICcwcHgnKTtcblxuXHRzZWxlY3QoJyNyaWdodC1wYW5lbCcpLnNlbGVjdCgnLmZsLWNvbC1jb250ZW50JykucHJvcGVydHkoJ3Njcm9sbFRvcCcsIDApO1xufTtcblxuY29uc3QgaGlkZVBhbmVsID0gYXN5bmMgKHtkaXJlY3Rpb24gPSAnbm9uZSd9KSA9PiB7XG5cblx0cmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuXG5cdFx0aWYgKGRpcmVjdGlvbiA9PSAnbm9uZScpIHtcblx0XHRcdGRpcmVjdGlvbiA9ICcwcHgnO1xuXHRcdH0gZWxzZSBpZiAoZGlyZWN0aW9uID09ICd1cCcpIHtcblx0XHRcdGRpcmVjdGlvbiA9ICctMjAwMHB4Jztcblx0XHR9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PSAnZG93bicpIHtcblx0XHRcdGRpcmVjdGlvbiA9ICcyMDAwcHgnO1xuXHRcdH1cblxuXHRcblx0XHRzZWxlY3QoJyNsZWZ0LXBhbmVsJylcblx0XHRcdC50cmFuc2l0aW9uKClcblx0XHRcdC5kZWxheSgwKVxuXHRcdFx0LmR1cmF0aW9uKGludGVybmFsT3B0aW9uLmFuaW1hdGlvbi5kdXJhdGlvbi5vdXQpXG5cdFx0XHQuc3R5bGUoJ29wYWNpdHknLCAwKVxuXHRcdFx0LnN0eWxlKCdtYXJnaW4tdG9wJywgZGlyZWN0aW9uKVxuXHRcdFx0Lm9uKCdlbmQnLCBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdHNlbGVjdCh0aGlzKS5zdHlsZSgnZGlzcGxheScsICdub25lJyk7XG5cdFx0XHR9KTtcblxuXHRcdHNlbGVjdCgnI21pZGRsZS1wYW5lbCcpXG5cdFx0XHQudHJhbnNpdGlvbigpXG5cdFx0XHQuZGVsYXkoMClcblx0XHRcdC5kdXJhdGlvbihpbnRlcm5hbE9wdGlvbi5hbmltYXRpb24uZHVyYXRpb24ub3V0KVxuXHRcdFx0LnN0eWxlKCdvcGFjaXR5JywgMClcblx0XHRcdC5zdHlsZSgnbWFyZ2luLXRvcCcsIGRpcmVjdGlvbilcblx0XHRcdC5vbignZW5kJywgZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRzZWxlY3QodGhpcykuc3R5bGUoJ2Rpc3BsYXknLCAnbm9uZScpO1xuXHRcdFx0fSk7XG5cblx0XHRzZWxlY3QoJyNyaWdodC1wYW5lbCcpXG5cdFx0XHQudHJhbnNpdGlvbigpXG5cdFx0XHQuZGVsYXkoMClcblx0XHRcdC5kdXJhdGlvbihpbnRlcm5hbE9wdGlvbi5hbmltYXRpb24uZHVyYXRpb24ub3V0KVxuXHRcdFx0LnN0eWxlKCdvcGFjaXR5JywgMClcblx0XHRcdC5zdHlsZSgnbWFyZ2luLXRvcCcsIGRpcmVjdGlvbilcblx0XHRcdC5vbignZW5kJywgZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRzZWxlY3QodGhpcykuc3R5bGUoJ2Rpc3BsYXknLCAnbm9uZScpO1xuXHRcdFx0XHRyZXNvbHZlKCk7XG5cdFx0XHR9KTtcblx0fSk7XG59O1xuXG5cbmNvbnN0IHNob3dQb3N0ID0gYXN5bmMgKHtpZCwgc2x1Z30pID0+IHtcblxuXHQvL3Bvc3REYXRhIC0gbG9hZCBieSBJRCBvciBieSBTbHVnXG5cdGNvbnN0IHBvc3REYXRhID0gYXdhaXQgbG9hZFBvc3Qoe2lkLHNsdWd9KTtcblx0Ly8gY29uc29sZS5sb2cocG9zdERhdGEpO1xuXHRpZiAoIXBvc3REYXRhKSByZXR1cm47XG5cblx0Y29uc3QgcG9zdENhdGVnb3JpZXMgPSBwb3N0RGF0YS5fZW1iZWRkZWRbJ3dwOnRlcm0nXVswXTtcblx0Y29uc3QgcG9zdFRhZ3MgPSBwb3N0RGF0YS5fZW1iZWRkZWRbJ3dwOnRlcm0nXVsxXTtcblxuXHQvLyBjb25zdCBwb3N0VGhlbWUgPSBwb3N0Q2F0ZWdvcmllc1swXS5zbHVnO1xuXHRsZXQgcG9zdFRoZW1lID0gcG9zdENhdGVnb3JpZXMuZmluZChjYXQgPT4gY2F0LnNsdWcgPT0gdGhlbWUuc2x1Zyk7XG5cblx0aWYgKCFwb3N0VGhlbWUpIHBvc3RUaGVtZSA9IHBvc3RDYXRlZ29yaWVzWzBdO1xuXHRcblx0aWYocG9zdFRoZW1lLnNsdWcgPT0gJ3VuY2F0ZWdvcml6ZWQnKSBjb25zb2xlLmxvZygnUHJvYmxlbSB3aXRoIGNhdGVnb3J5IFwidW5jYXRlZ29yaXplZFwiOiAnLCBwb3N0RGF0YSk7XG5cblx0c2V0VGhlbWUocG9zdFRoZW1lLnNsdWcpO1xuXHRpZiAodGhlbWUuaXNOZXcpIHVwZGF0ZU1hcCh0aGVtZSk7XG5cdFxuXHRhd2FpdCBoaWRlUGFuZWwoe2RpcmVjdGlvbjogJ3VwJ30pO1xuXG5cdHVwZGF0ZVBvc3QocG9zdERhdGEscG9zdFRhZ3MpO1xuXG5cdC8vc2hvdyBQYW5lbFxuXHRzaG93UGFuZWwoe2RpcmVjdGlvbjogJ2Rvd24nLCBkZWxheTogMH0pO1xuXG5cdGNoYW5nZUJyb3dzZXJIaXN0b3J5KHtcblx0XHR0aXRsZTogcG9zdERhdGEudGl0bGUucmVuZGVyZWQsXG5cdFx0c2x1ZzogcG9zdERhdGEuc2x1Z1xuXHR9KTtcblxuXHRyZXR1cm4ge1xuXHRcdHBvc3Q6IHBvc3REYXRhLFxuXHRcdHRoZW1lOiBwb3N0VGhlbWVcblx0fTtcblxufTtcblxuY29uc3QgbG9hZFBvc3QgPSBhc3luYyAoe2lkLCBzbHVnfSkgPT4ge1xuXG5cdGxldCBwb3N0RGF0YTtcblxuXHRpZiAoaWQpIHtcblx0XHRwb3N0RGF0YSA9IGF3YWl0IHdwLnBvc3RzKCkuaWQoaWQpLmVtYmVkKCk7XG5cdH0gZWxzZSBpZiAoc2x1Zykge1xuXHRcdHBvc3REYXRhID0gYXdhaXQgd3AucG9zdHMoKS5zbHVnKHNsdWcpLmVtYmVkKCk7XG5cdFx0cG9zdERhdGEgPSBwb3N0RGF0YVswXTtcblx0fVxuXG5cdHJldHVybiBwb3N0RGF0YTtcbn07XG5cbmNvbnN0IHVwZGF0ZVBvc3QgPSAoe3RpdGxlLCBjb250ZW50fSwgdGFncykgPT4ge1xuXHQvL0RPTSBtYW5pcHVsYXRpb25cblx0Y29uc3QgcGFuZWwgPSBzZWxlY3QoJyNyaWdodC1wYW5lbCcpO1xuXG5cdHBhbmVsLnNlbGVjdCgnI2FydGljbGUtdGl0bGUnKS5zZWxlY3QoJy5mbC1oZWFkaW5nLXRleHQnKS5odG1sKHRpdGxlLnJlbmRlcmVkKTtcblx0cGFuZWwuc2VsZWN0KCcjYXJ0aWNsZS1jb250ZW50Jykuc2VsZWN0KCcuZmwtcmljaC10ZXh0JykuaHRtbChjb250ZW50LnJlbmRlcmVkKTtcblx0cGFuZWwuc2VsZWN0KCcudGFnbGluZScpLnNlbGVjdCgnLmZsLWhlYWRpbmctdGV4dCcpLmh0bWwodGhlbWUuc2x1Zyk7XG5cblx0Ly90YWdzXG5cdGNvbnN0IHRhZ3NESVYgPSBwYW5lbC5zZWxlY3QoJyNhcnRpY2xlLXRhZ3MnKS5zZWxlY3QoJy5mbC1odG1sJyk7XG5cdGxldCB0YWdzSFRNTCA9ICc8ZGl2IGlkPVwidGFnLWNvbnRhaW5lclwiPic7XG5cdGZvciAoY29uc3QgdGFnIG9mIHRhZ3MpIHtcblx0XHR0YWdzSFRNTCArPSBgPGRpdiBpZD1cInRhZy0ke3RhZy5zbHVnfVwiIGNsYXNzPVwidGFnLXBpbGxcIj4ke3RhZy5uYW1lfTwvZGl2PmA7XG5cdH1cblx0dGFnc0hUTUwgKz0gJzwvZGl2Pic7XG5cblx0dGFnc0RJVi5odG1sKHRhZ3NIVE1MKTtcblxuXHRjYXB0dXJlTGlua3MoKTtcbn07XG5cbmNvbnN0IHNob3dQYWdlID0gYXN5bmMgKHtpZCwgc2x1Z30pID0+IHtcblxuXHRhd2FpdCBzZXRUaGVtZShzbHVnKTtcblxuXHRpZiAodGhlbWUuaXNOZXcpIHVwZGF0ZU1hcCh0aGVtZSk7XG5cblx0aWYgKGlkID09IDApIHtcblx0XHRjaGFuZ2VCcm93c2VySGlzdG9yeSh7c2x1ZzogJy9naG9zdC1yaXZlci8nfSk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cdFx0XG5cdGNvbnN0IHBhZ2VEYXRhID0gYXdhaXQgbG9hZFBhZ2Uoe2lkLCBzbHVnfSk7XG5cdC8vIGNvbnNvbGUubG9nKHBhZ2VEYXRhKTtcblx0XG5cdHVwZGF0ZVBhZ2UocGFnZURhdGEpO1xuXHRcblx0Ly9zaG93IHBhbmVsXG5cdHNob3dQYW5lbCh7ZGlyZWN0aW9uOiAnZG93bicsIGRlbGF5OiAwfSk7XG5cblx0Y2hhbmdlQnJvd3Nlckhpc3Rvcnkoe1xuXHRcdHRpdGxlOiBwYWdlRGF0YS50aXRsZS5yZW5kZXJlZCxcblx0XHRzbHVnOiBwYWdlRGF0YS5zbHVnXG5cdH0pO1xuXG5cdHJldHVybiBwYWdlRGF0YTtcblx0XG59O1xuXG5jb25zdCBzZXRUaGVtZSA9IGFzeW5jIHJlcXVlc3RlZFRoZW1lU2x1ZyA9PiB7XG5cblx0dGhlbWUuaXNOZXcgPSBmYWxzZTtcblx0XG5cdGlmKHRoZW1lLnNsdWcgIT0gcmVxdWVzdGVkVGhlbWVTbHVnKSB7XG5cdFx0Y29uc3QgcmVxdWVzdGVkVGhlbWUgPSBnZXRUaGVtZUJ5U2x1ZyhyZXF1ZXN0ZWRUaGVtZVNsdWcpO1xuXHRcdGNoYW5nZVN0YXRlKHJlcXVlc3RlZFRoZW1lLnN0YXRlKTtcblx0XHR0aGVtZSA9IHJlcXVlc3RlZFRoZW1lO1xuXHRcdHRoZW1lLmlzTmV3ID0gdHJ1ZTtcblx0fVxuXG5cdGlmICh0aGVtZS5zbHVnICE9ICdob21lJykgYXdhaXQgaGlkZVBhbmVsKHtkaXJlY3Rpb246ICd1cCd9KTtcblx0XG5cdHJldHVybiB0aGVtZTtcbn07XG5cbmNvbnN0IHVwZGF0ZU1hcCA9IGFzeW5jICh7bm90Rm91bmR9KSA9PiB7XG5cblx0aWYoIW1hcEFQSS5pc01hcGJveExvYWRlZCgpKSB7XG5cdFx0aWYgKG5vdEZvdW5kID09IHRydWUpIHtcblx0XHRcdGF3YWl0IG1hcEFQSS5pbml0KHtub3RGb3VuZH0pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRhd2FpdCBtYXBBUEkuaW5pdCh0aGVtZSk7XG5cdFx0fVxuXHRcdFxuXHR9IGVsc2Uge1xuXHRcdGF3YWl0IG1hcEFQSS5jaGFuZ2VNYXAodGhlbWUpO1xuXHR9XG5cblx0ZGF0YXZpcy5kcmF3Tm9kZXModGhlbWUpO1xufTtcblxuXG5jb25zdCBjaGFuZ2VTdGF0ZSA9IG5ld1N0YXRlID0+IHtcblxuXHRpZiAobmV3U3RhdGUgIT0gdGhlbWUuc3RhdGUpIHtcblx0XHRpZiAobmV3U3RhdGUgPT09ICdob21lJykge1xuXHRcdFx0aGlkZVRvcE1lbnUoKTtcblx0XHRcdGhpZGVQYW5lbCh7ZGlyZWN0aW9uOiAndXAnfSk7XG5cdFx0XHRzaG93SG9tZSgpO1xuXHRcdH0gZWxzZSBpZiAobmV3U3RhdGUgPT09ICdwYWdlJykge1xuXHRcdFx0aGlkZUhvbWUoKTtcblx0XHRcdHNob3dUb3BNZW51KCk7XG5cdFx0fVxuXHR9XG5cdFxufTtcblxuY29uc3QgbG9hZFBhZ2UgPSBhc3luYyAoe2lkLCBzbHVnfSkgPT4ge1xuXHRsZXQgcGFnZURhdGE7XG5cblx0aWYgKGlkKSB7XG5cdFx0cGFnZURhdGEgPSBhd2FpdCB3cC5wYWdlcygpLmlkKGlkKS5lbWJlZCgpO1xuXHR9IGVsc2UgaWYgKHNsdWcpIHtcblx0XHRwYWdlRGF0YSA9IGF3YWl0IHdwLnBhZ2VzKCkuc2x1ZyhzbHVnKS5lbWJlZCgpO1xuXHRcdHBhZ2VEYXRhID0gcGFnZURhdGFbMF07XG5cdH1cblxuXHRyZXR1cm4gcGFnZURhdGE7XG59O1xuXG5jb25zdCB1cGRhdGVQYWdlID0gKHt0aXRsZSwgY29udGVudH0pID0+IHtcblx0Ly9kb20gbWFuaXB1bGF0aW9uXG5cdHNlbGVjdCgnI3JpZ2h0LXBhbmVsJykuc2VsZWN0KCcjYXJ0aWNsZS10aXRsZScpLnNlbGVjdCgnLmZsLWhlYWRpbmctdGV4dCcpLmh0bWwodGl0bGUucmVuZGVyZWQpO1xuXHRzZWxlY3QoJyNyaWdodC1wYW5lbCcpLnNlbGVjdCgnI2FydGljbGUtY29udGVudCcpLnNlbGVjdCgnLmZsLXJpY2gtdGV4dCcpLmh0bWwoY29udGVudC5yZW5kZXJlZCk7XG5cdHNlbGVjdCgnI3JpZ2h0LXBhbmVsJykuc2VsZWN0KCcudGFnbGluZScpLnNlbGVjdCgnLmZsLWhlYWRpbmctdGV4dCcpLmh0bWwoJycpO1xuXHRzZWxlY3QoJyNyaWdodC1wYW5lbCcpLnNlbGVjdCgnI2FydGljbGUtdGFncycpLnNlbGVjdCgnLmZsLWh0bWwnKS5odG1sKCcnKTtcblx0Y2FwdHVyZUxpbmtzKCk7XG59O1xuXG5jb25zdCBjYXB0dXJlTGlua3MgPSAoKSA9PiB7XG5cdHNlbGVjdEFsbCgnYScpXG5cdFx0Lm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcblxuXHRcdFx0Ly9nZXQgdXJsIC8vIGRvbWFpblxuXHRcdFx0Y29uc3QgbGluayA9IHNlbGVjdCh0aGlzKS5hdHRyKCdocmVmJyk7XG5cdFx0XHRjb25zdCBkb21haW4gPSBsaW5rLnNwbGl0KCcvJylbMl07XG5cblx0XHRcdC8vVGVzdCBpZiBpdCBpcyBhIGxvY2FsIGxpbmsgKGxvY2FsaG9zdCAtPiByZW1vdGUpXG5cdFx0XHRjb25zdCBob3N0ID0gKHdpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZSA9PSAnbG9jYWxob3N0JykgPyAnbGFicy5mbHV4by5hcnQuYnInIDogd2luZG93LmxvY2F0aW9uLmhvc3RuYW1lO1xuXG5cdFx0XHQvL2lmIGV4dHJybmFsLCBuYXZpZ2F0ZVxuXHRcdFx0aWYgKGRvbWFpbiAhPSBob3N0KSByZXR1cm47IC8vd2luZG93LmxvY2F0aW9uLmhvc3RuYW1lXG5cblx0XHRcdC8vaWYgbG9jYWwsIHByZXZlbnQgcGFnZSB1cGRhdGVcblx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRcdC8vbG9hZCBwb3N0IGJhc2VkIG9uIHNsdWcgb24gdGhlIHVybFxuXHRcdFx0Y29uc3Qgc2x1ZyA9IGxpbmsuc3BsaXQoJy8nKVs0XTtcblxuXHRcdFx0c2hvd1Bvc3Qoe3NsdWd9KTtcblx0XHR9KTtcblxufTtcblxuY29uc3QgY2hhbmdlQnJvd3Nlckhpc3RvcnkgPSAoe3RpdGxlLHNsdWd9KSA9PiB7XG5cblx0bGV0IHBhZ2VUaXRsZSA9ICdHaG9zdCBSaXZlcic7XG5cdGlmICh0aXRsZSkgcGFnZVRpdGxlICs9IGAgLSAke3RpdGxlfWA7XG5cblx0ZG9jdW1lbnQudGl0bGUgPSBwYWdlVGl0bGU7XG5cdHdpbmRvdy5oaXN0b3J5LnB1c2hTdGF0ZShcblx0XHR7cGFnZVRpdGxlfSxcblx0XHQnJyxcblx0XHRzbHVnKTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IHtcblx0aW5pdEhvbWUsXG5cdHNob3dQb3N0LFxuXHRzaG93UGFnZSxcblx0bG9hZFBhZ2UsXG5cdGNoYW5nZUJyb3dzZXJIaXN0b3J5LFxuXHRnZXRUaGVtZUJ5U2x1Z1xufTsiXSwic291cmNlUm9vdCI6IiJ9